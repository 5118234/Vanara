<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CredUI.CredUIConfirmCredentials Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="CredUIConfirmCredentials method" /><meta name="System.Keywords" content="CredUI.CredUIConfirmCredentials method" /><meta name="Microsoft.Help.F1" content="Vanara.PInvoke.CredUI.CredUIConfirmCredentials" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.CredUI.CredUIConfirmCredentials(System.String,System.Boolean)" /><meta name="Description" content="The CredUIConfirmCredentials function is called after CredUIPromptForCredentials or CredUICmdLinePromptForCredentials, to confirm the validity of the credential harvested." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="d31b9fdc-1e87-d670-a1e8-01f08ab39228" /><meta name="guid" content="d31b9fdc-1e87-d670-a1e8-01f08ab39228" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d445925c-fdc1-230a-be29-e0966d4ee127.htm" title="CredUI Class" tocid="d445925c-fdc1-230a-be29-e0966d4ee127">CredUI Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="2d63e544-46ae-cf06-bc7c-d317fc31cb8d.htm" title="CredUI Methods" tocid="2d63e544-46ae-cf06-bc7c-d317fc31cb8d">CredUI Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="87efc117-dbf4-9c12-ab0e-41947c10f63c.htm" title="CredPackAuthenticationBuffer Method " tocid="87efc117-dbf4-9c12-ab0e-41947c10f63c">CredPackAuthenticationBuffer Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="d31b9fdc-1e87-d670-a1e8-01f08ab39228.htm" title="CredUIConfirmCredentials Method " tocid="d31b9fdc-1e87-d670-a1e8-01f08ab39228">CredUIConfirmCredentials Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="fab35c9c-fe4d-455a-3102-36b9ec9e1f6e.htm" title="CredUIParseUserName Method " tocid="fab35c9c-fe4d-455a-3102-36b9ec9e1f6e">CredUIParseUserName Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="fa2179eb-ae04-24b5-2c60-6c106dbf2b18.htm" title="CredUIPromptForCredentials Method " tocid="fa2179eb-ae04-24b5-2c60-6c106dbf2b18">CredUIPromptForCredentials Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="f0c3c77b-ae98-a90e-20d4-40a2b14f73a2.htm" title="CredUIPromptForWindowsCredentials Method " tocid="f0c3c77b-ae98-a90e-20d4-40a2b14f73a2">CredUIPromptForWindowsCredentials Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="9f6d6707-9be5-097a-bef1-906d9b5b3983.htm" title="CredUnPackAuthenticationBuffer Method " tocid="9f6d6707-9be5-097a-bef1-906d9b5b3983">CredUnPackAuthenticationBuffer Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>CredUI<span id="LST75020BBB_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST75020BBB_0?cpp=::|nu=.");</script>CredUIConfirmCredentials Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            The CredUIConfirmCredentials function is called after CredUIPromptForCredentials or CredUICmdLinePromptForCredentials, to confirm the validity of the credential harvested. CredUIConfirmCredentials must be called if the CREDUI_FLAGS_EXPECT_CONFIRMATION flag was passed to the "prompt" function, either CredUIPromptForCredentials or CredUICmdLinePromptForCredentials, and the "prompt" function returned NO_ERROR.
            <p>After calling the "prompt" function and before calling CredUIConfirmCredentials, the caller must determine whether the credentials are actually valid by using the credentials to access the resource specified by pszTargetName. The results of that validation test are passed to CredUIConfirmCredentials in the bConfirm parameter.</p></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.CredUI (in Vanara.PInvoke.CredUI.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">Win32Error</span> <span class="identifier">CredUIConfirmCredentials</span>(
	<span class="identifier">string</span> <span class="parameter">targetName</span>,
	<span class="identifier">bool</span> <span class="parameter">confirm</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">CredUIConfirmCredentials</span> ( 
	<span class="parameter">targetName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">confirm</span> <span class="keyword">As</span> <span class="identifier">Boolean</span>
) <span class="keyword">As</span> <span class="identifier">Win32Error</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">targetName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST75020BBB_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST75020BBB_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />Pointer to a null-terminated string that contains the name of the target for the credentials, typically a domain or server application name. This must be the same value passed as pszTargetName to CredUIPromptForCredentials or CredUICmdLinePromptForCredentials</dd><dt><span class="parameter">confirm</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System<span id="LST75020BBB_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST75020BBB_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Boolean</a><br />Specifies whether the credentials returned from the prompt function are valid. If TRUE, the credentials are stored in the credential manager as defined by CredUIPromptForCredentials or CredUICmdLinePromptForCredentials. If FALSE, the credentials are not stored and various pieces of memory are cleaned up.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="08c41376-0893-e74a-adcf-6b5194603d48.htm">Win32Error</a><br />Status of the operation is returned. The caller can check this status to determine whether the credential confirm operation succeeded. Most applications ignore this status code because the application's connection to the resource has already been done. The operation can fail because the credential was not found on the list of credentials awaiting confirmation, or because the attempt to write or delete the credential failed. Failure to find the credential on the list can occur because the credential was never queued or as a result of too many credentials being queued. Up to five credentials can be queued before older ones are discarded as newer ones are queued.</div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="d445925c-fdc1-230a-be29-e0966d4ee127.htm">CredUI Class</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>