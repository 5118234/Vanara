<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>NetApi32.NetServerEnum Method (String, Int32, NetApi32.SafeNetApiBuffer, Int32, Int32, Int32, NetApi32.NetServerEnumFilter, String, IntPtr)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.NetApi32.NetServerEnum(System.String,System.Int32,Vanara.PInvoke.NetApi32.SafeNetApiBuffer@,System.Int32,System.Int32@,System.Int32@,Vanara.PInvoke.NetApi32.NetServerEnumFilter,System.String,System.IntPtr)" /><meta name="Description" content="The NetServerEnum function lists all servers of the specified type that are visible in a domain." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="54a1b774-1a13-aed2-eede-2988fa2dc7b3" /><meta name="guid" content="54a1b774-1a13-aed2-eede-2988fa2dc7b3" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="2510fc80-0efd-8116-9cb3-b8b0114baa11.htm" title="NetApi32 Class" tocid="2510fc80-0efd-8116-9cb3-b8b0114baa11">NetApi32 Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="1dd24639-0f3f-3b3f-e083-4f373692ea05.htm" title="NetApi32 Methods" tocid="1dd24639-0f3f-3b3f-e083-4f373692ea05">NetApi32 Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="0734c118-3982-c2b8-d033-0986b11b253b.htm" title="NetServerEnum Method " tocid="0734c118-3982-c2b8-d033-0986b11b253b">NetServerEnum Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9cfd32cd-50fd-1144-d7a2-5eed2a8f4468.htm" title="NetServerEnum(T) Method (NetApi32.NetServerEnumFilter, String, Int32)" tocid="9cfd32cd-50fd-1144-d7a2-5eed2a8f4468">NetServerEnum(T) Method (NetApi32.NetServerEnumFilter, String, Int32)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="54a1b774-1a13-aed2-eede-2988fa2dc7b3.htm" title="NetServerEnum Method (String, Int32, NetApi32.SafeNetApiBuffer, Int32, Int32, Int32, NetApi32.NetServerEnumFilter, String, IntPtr)" tocid="54a1b774-1a13-aed2-eede-2988fa2dc7b3">NetServerEnum Method (String, Int32, NetApi32.SafeNetApiBuffer, Int32, Int32, Int32, NetApi32.NetServerEnumFilter, String, IntPtr)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>NetApi32<span id="LSTADF5F28D_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_0?cpp=::|nu=.");</script>NetServerEnum Method (String, Int32, NetApi32<span id="LSTADF5F28D_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_1?cpp=::|nu=.");</script>SafeNetApiBuffer<span id="LSTADF5F28D_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_2?cpp=%");</script>, Int32, Int32<span id="LSTADF5F28D_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_3?cpp=%");</script>, Int32<span id="LSTADF5F28D_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_4?cpp=%");</script>, NetApi32<span id="LSTADF5F28D_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_5?cpp=::|nu=.");</script>NetServerEnumFilter, String, IntPtr)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">The NetServerEnum function lists all servers of the specified type that are visible in a domain.</div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.NetApi32 (in Vanara.PInvoke.NetApi32.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">Win32Error</span> <span class="identifier">NetServerEnum</span>(
	<span class="identifier">string</span> <span class="parameter">servernane</span>,
	<span class="identifier">int</span> <span class="parameter">level</span>,
	<span class="keyword">out</span> <span class="identifier">NetApi32<span id="LSTADF5F28D_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeNetApiBuffer</span> <span class="parameter">bufptr</span>,
	<span class="identifier">int</span> <span class="parameter">prefmaxlen</span>,
	<span class="keyword">out</span> <span class="identifier">int</span> <span class="parameter">entriesread</span>,
	<span class="keyword">out</span> <span class="identifier">int</span> <span class="parameter">totalentries</span>,
	<span class="identifier">NetApi32<span id="LSTADF5F28D_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>NetServerEnumFilter</span> <span class="parameter">servertype</span>,
	<span class="identifier">string</span> <span class="parameter">domain</span>,
	<span class="identifier">IntPtr</span> <span class="parameter">resume_handle</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">NetServerEnum</span> ( 
	<span class="parameter">servernane</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">level</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">bufptr</span> <span class="keyword">As</span> <span class="identifier">NetApi32<span id="LSTADF5F28D_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeNetApiBuffer</span>,
	<span class="parameter">prefmaxlen</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">entriesread</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">totalentries</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">servertype</span> <span class="keyword">As</span> <span class="identifier">NetApi32<span id="LSTADF5F28D_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>NetServerEnumFilter</span>,
	<span class="parameter">domain</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">resume_handle</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>
) <span class="keyword">As</span> <span class="identifier">Win32Error</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">servernane</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTADF5F28D_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />Reserved; must be NULL.</dd><dt><span class="parameter">level</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LSTADF5F28D_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />The information level of the data requested.</dd><dt><span class="parameter">bufptr</span></dt><dd>Type: <a href="c2390699-edae-f0ef-5f18-be4a1d0c1605.htm">Vanara.PInvoke<span id="LSTADF5F28D_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>NetApi32<span id="LSTADF5F28D_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeNetApiBuffer</a><span id="LSTADF5F28D_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_14?cpp=%");</script><br />
            A pointer to the buffer that receives the data. The format of this data depends on the value of the level parameter. This buffer is allocated by the
            system and must be freed using the NetApiBufferFree function. Note that you must free the buffer even if the function fails with ERROR_MORE_DATA.
            </dd><dt><span class="parameter">prefmaxlen</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LSTADF5F28D_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_15?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />
            The preferred maximum length of returned data, in bytes. If you specify MAX_PREFERRED_LENGTH, the function allocates the amount of memory required
            for the data. If you specify another value in this parameter, it can restrict the number of bytes that the function returns. If the buffer size is
            insufficient to hold all entries, the function returns ERROR_MORE_DATA. For more information, see Network Management Function Buffers and Network
            Management Function Buffer Lengths.
            </dd><dt><span class="parameter">entriesread</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LSTADF5F28D_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_16?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><span id="LSTADF5F28D_17"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_17?cpp=%");</script><br />A pointer to a value that receives the count of elements actually enumerated.</dd><dt><span class="parameter">totalentries</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LSTADF5F28D_18"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_18?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><span id="LSTADF5F28D_19"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_19?cpp=%");</script><br />
            A pointer to a value that receives the total number of visible servers and workstations on the network. Note that applications should consider this
            value only as a hint.
            </dd><dt><span class="parameter">servertype</span></dt><dd>Type: <a href="8d50249d-c4c3-dc65-d33f-a3815fe5875b.htm">Vanara.PInvoke<span id="LSTADF5F28D_20"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_20?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>NetApi32<span id="LSTADF5F28D_21"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_21?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>NetServerEnumFilter</a><br />A value that filters the server entries to return from the enumeration.</dd><dt><span class="parameter">domain</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTADF5F28D_22"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_22?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
            A pointer to a constant string that specifies the name of the domain for which a list of servers is to be returned. The domain name must be a NetBIOS
            domain name (for example, microsoft). The NetServerEnum function does not support DNS-style names (for example, microsoft.com). If this parameter is
            NULL, the primary domain is implied.
            </dd><dt><span class="parameter">resume_handle</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LSTADF5F28D_23"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTADF5F28D_23?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><br />Reserved; must be set to zero.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="08c41376-0893-e74a-adcf-6b5194603d48.htm">Win32Error</a><br />If the function succeeds, the return value is NERR_Success.</div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="2510fc80-0efd-8116-9cb3-b8b0114baa11.htm">NetApi32 Class</a></div><div class="seeAlsoStyle"><a href="0734c118-3982-c2b8-d033-0986b11b253b.htm">NetServerEnum Overload</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>