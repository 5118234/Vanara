<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>SystemShutdown.InitiateShutdown Method (String, String, TimeSpan, AdvApi32.ShutdownFlags, SystemShutDownReason)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Vanara.Diagnostics.SystemShutdown.InitiateShutdown(System.String,System.String,System.TimeSpan,Vanara.PInvoke.AdvApi32.ShutdownFlags,Vanara.PInvoke.SystemShutDownReason)" /><meta name="Description" content="Initiates a shutdown and restart of the specified computer, and restarts any applications that have been registered for restart." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.Diagnostics" /><meta name="file" content="1c3f2ddc-5e1b-043f-b3a1-ba37dfcbc377" /><meta name="guid" content="1c3f2ddc-5e1b-043f-b3a1-ba37dfcbc377" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="ae9a7c38-6642-96aa-d3f5-fcde8a4bd54e.htm" title="Vanara.Diagnostics" tocid="ae9a7c38-6642-96aa-d3f5-fcde8a4bd54e">Vanara.Diagnostics</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="ad6f6ae9-fa9f-8e45-4be0-0a56f367e403.htm" title="SystemShutdown Class" tocid="ad6f6ae9-fa9f-8e45-4be0-0a56f367e403">SystemShutdown Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="3918f9eb-7ec1-a647-07cc-86d1c04e61a5.htm" title="SystemShutdown Methods" tocid="3918f9eb-7ec1-a647-07cc-86d1c04e61a5">SystemShutdown Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="aefa53cb-b41c-5db7-aa3c-4616f1edeb8b.htm" title="InitiateShutdown Method " tocid="aefa53cb-b41c-5db7-aa3c-4616f1edeb8b">InitiateShutdown Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="1c3f2ddc-5e1b-043f-b3a1-ba37dfcbc377.htm" title="InitiateShutdown Method (String, String, TimeSpan, AdvApi32.ShutdownFlags, SystemShutDownReason)" tocid="1c3f2ddc-5e1b-043f-b3a1-ba37dfcbc377">InitiateShutdown Method (String, String, TimeSpan, AdvApi32.ShutdownFlags, SystemShutDownReason)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="0d6d6cfc-c6ba-99e1-b379-80effbcda490.htm" title="InitiateShutdown Method (String, String, Nullable(TimeSpan), Boolean, Boolean, SystemShutDownReason)" tocid="0d6d6cfc-c6ba-99e1-b379-80effbcda490">InitiateShutdown Method (String, String, Nullable(TimeSpan), Boolean, Boolean, SystemShutDownReason)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>SystemShutdown<span id="LSTAF5C9576_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTAF5C9576_0?cpp=::|nu=.");</script>InitiateShutdown Method (String, String, TimeSpan, AdvApi32<span id="LSTAF5C9576_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTAF5C9576_1?cpp=::|nu=.");</script>ShutdownFlags, SystemShutDownReason)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Initiates a shutdown and restart of the specified computer, and restarts any applications that have been registered for restart.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="ae9a7c38-6642-96aa-d3f5-fcde8a4bd54e.htm">Vanara.Diagnostics</a><br />
    <strong>Assembly:</strong>
   Vanara.UI (in Vanara.UI.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">InitiateShutdown</span>(
	<span class="identifier">string</span> <span class="parameter">machineName</span>,
	<span class="identifier">string</span> <span class="parameter">message</span>,
	<span class="identifier">TimeSpan</span> <span class="parameter">gracePeriod</span>,
	<span class="identifier">AdvApi32<span id="LSTAF5C9576_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTAF5C9576_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ShutdownFlags</span> <span class="parameter">flags</span>,
	<span class="identifier">SystemShutDownReason</span> <span class="parameter">reason</span> = <span class="identifier">SystemShutDownReason</span>.SHTDN_REASON_MINOR_NONE
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Sub</span> <span class="identifier">InitiateShutdown</span> ( 
	<span class="parameter">machineName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">message</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">gracePeriod</span> <span class="keyword">As</span> <span class="identifier">TimeSpan</span>,
	<span class="parameter">flags</span> <span class="keyword">As</span> <span class="identifier">AdvApi32<span id="LSTAF5C9576_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTAF5C9576_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ShutdownFlags</span>,
	Optional <span class="parameter">reason</span> <span class="keyword">As</span> <span class="identifier">SystemShutDownReason</span> = <span class="identifier">SystemShutDownReason</span>.SHTDN_REASON_MINOR_NONE
)</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">machineName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTAF5C9576_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTAF5C9576_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The name of the computer to be shut down. If the value of this parameter is NULL, the local computer is shut down.</dd><dt><span class="parameter">message</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTAF5C9576_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTAF5C9576_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />The message to be displayed in the interactive shutdown dialog box.</dd><dt><span class="parameter">gracePeriod</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/269ew577" target="_blank">System<span id="LSTAF5C9576_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTAF5C9576_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>TimeSpan</a><br />The number of seconds to wait before shutting down the computer. If the value of this parameter is zero, the computer is shut down immediately. This value is limited to MAX_SHUTDOWN_TIMEOUT.
            <p>If the value of this parameter is greater than zero, and the dwShutdownFlags parameter specifies the flag SHUTDOWN_GRACE_OVERRIDE, the function fails and returns the error code ERROR_BAD_ARGUMENTS.</p></dd><dt><span class="parameter">flags</span></dt><dd>Type: <a href="728d0256-8c9a-9857-c5ee-fdce9769dd9e.htm">Vanara.PInvoke<span id="LSTAF5C9576_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTAF5C9576_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AdvApi32<span id="LSTAF5C9576_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTAF5C9576_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ShutdownFlags</a><br />One or more bit flags that specify options for the shutdown.</dd><dt><span class="parameter">reason</span> (Optional)</dt><dd>Type: <a href="40cb638e-0d10-5fcb-a75d-49f0b5926c63.htm">Vanara.PInvoke<span id="LSTAF5C9576_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTAF5C9576_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SystemShutDownReason</a><br />The reason for initiating the shutdown. This parameter must be one of the system shutdown reason codes. If this parameter is zero, the default is an undefined shutdown that is logged as "No title for this reason could be found". By default, it is also an unplanned shutdown. Depending on how the system is configured, an unplanned shutdown triggers the creation of a file that contains the system state information, which can delay shutdown. Therefore, do not use zero for this parameter.</dd></dl></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="ad6f6ae9-fa9f-8e45-4be0-0a56f367e403.htm">SystemShutdown Class</a></div><div class="seeAlsoStyle"><a href="aefa53cb-b41c-5db7-aa3c-4616f1edeb8b.htm">InitiateShutdown Overload</a></div><div class="seeAlsoStyle"><a href="ae9a7c38-6642-96aa-d3f5-fcde8a4bd54e.htm">Vanara.Diagnostics Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>