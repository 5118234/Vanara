<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ole32.StgOpenStorageEx Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="StgOpenStorageEx method" /><meta name="System.Keywords" content="Ole32.StgOpenStorageEx method" /><meta name="Microsoft.Help.F1" content="Vanara.PInvoke.Ole32.StgOpenStorageEx" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.Ole32.StgOpenStorageEx(System.String,Vanara.PInvoke.STGM,Vanara.PInvoke.Ole32.STGFMT,Vanara.PInvoke.FileFlagsAndAttributes,Vanara.PInvoke.Ole32.STGOPTIONS@,System.IntPtr,System.Guid,System.Object@)" /><meta name="Description" content="STGs the open storage ex." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="f449634d-cd1a-db9d-2297-5ef962cdf2a7" /><meta name="guid" content="f449634d-cd1a-db9d-2297-5ef962cdf2a7" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="34191c95-a05e-a3a2-0f94-c72e121807f5.htm" title="Ole32 Class" tocid="34191c95-a05e-a3a2-0f94-c72e121807f5">Ole32 Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c35bbc54-4863-ba25-6689-a59b4f48268d.htm" title="Ole32 Methods" tocid="c35bbc54-4863-ba25-6689-a59b4f48268d">Ole32 Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d2ddcd7f-2ce5-2da2-3ebe-1a1eb5e4dbc1.htm" title="CoInitializeEx Method " tocid="d2ddcd7f-2ce5-2da2-3ebe-1a1eb5e4dbc1">CoInitializeEx Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9a875657-14bc-e447-a210-5038dd11a029.htm" title="CoUninitialize Method " tocid="9a875657-14bc-e447-a210-5038dd11a029">CoUninitialize Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="10fb1f1e-7530-d083-2173-4901fdaf145d.htm" title="OleInitialize Method " tocid="10fb1f1e-7530-d083-2173-4901fdaf145d">OleInitialize Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9608851b-8a96-8706-4907-957c96e91a95.htm" title="OleUninitialize Method " tocid="9608851b-8a96-8706-4907-957c96e91a95">OleUninitialize Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="a2915927-ebc8-1b9d-0f65-02a19e69d7da.htm" title="PropVariantClear Method " tocid="a2915927-ebc8-1b9d-0f65-02a19e69d7da">PropVariantClear Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="dc166849-fc03-17d9-b220-6ee8bc9bf7a9.htm" title="PropVariantCopy Method " tocid="dc166849-fc03-17d9-b220-6ee8bc9bf7a9">PropVariantCopy Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="8e001a9b-c404-7519-623f-f24913d92bf1.htm" title="ReleaseStgMedium Method " tocid="8e001a9b-c404-7519-623f-f24913d92bf1">ReleaseStgMedium Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="015649d5-b3cc-519f-9b42-c971c5c6ba20.htm" title="StgCreateStorageEx Method " tocid="015649d5-b3cc-519f-9b42-c971c5c6ba20">StgCreateStorageEx Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="27d0717e-d8ab-362b-70f6-42fc293a2835.htm" title="StgIsStorageFile Method " tocid="27d0717e-d8ab-362b-70f6-42fc293a2835">StgIsStorageFile Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9c5c7981-9a25-b370-5ff8-217da6dd172e.htm" title="StgOpenStorage Method " tocid="9c5c7981-9a25-b370-5ff8-217da6dd172e">StgOpenStorage Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="f449634d-cd1a-db9d-2297-5ef962cdf2a7.htm" title="StgOpenStorageEx Method " tocid="f449634d-cd1a-db9d-2297-5ef962cdf2a7">StgOpenStorageEx Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Ole32<span id="LSTE2633870_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_0?cpp=::|nu=.");</script>StgOpenStorageEx Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">STGs the open storage ex.</div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.Ole (in Vanara.PInvoke.Ole.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">HRESULT</span> <span class="identifier">StgOpenStorageEx</span>(
	<span class="identifier">string</span> <span class="parameter">pwcsName</span>,
	<span class="identifier">STGM</span> <span class="parameter">grfMode</span>,
	<span class="identifier">Ole32<span id="LSTE2633870_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>STGFMT</span> <span class="parameter">stgfmt</span>,
	<span class="identifier">FileFlagsAndAttributes</span> <span class="parameter">grfAttrs</span>,
	<span class="keyword">ref</span> <span class="identifier">Ole32<span id="LSTE2633870_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>STGOPTIONS</span> <span class="parameter">pStgOptions</span>,
	<span class="identifier">IntPtr</span> <span class="parameter">reserved2</span>,
	<span class="identifier">Guid</span> <span class="parameter">riid</span>,
	<span class="keyword">out</span> <span class="identifier">Object</span> <span class="parameter">ppObjectOpen</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">StgOpenStorageEx</span> ( 
	<span class="parameter">pwcsName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">grfMode</span> <span class="keyword">As</span> <span class="identifier">STGM</span>,
	<span class="parameter">stgfmt</span> <span class="keyword">As</span> <span class="identifier">Ole32<span id="LSTE2633870_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>STGFMT</span>,
	<span class="parameter">grfAttrs</span> <span class="keyword">As</span> <span class="identifier">FileFlagsAndAttributes</span>,
	<span class="keyword">ByRef</span> <span class="parameter">pStgOptions</span> <span class="keyword">As</span> <span class="identifier">Ole32<span id="LSTE2633870_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>STGOPTIONS</span>,
	<span class="parameter">reserved2</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">riid</span> <span class="keyword">As</span> <span class="identifier">Guid</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">ppObjectOpen</span> <span class="keyword">As</span> <span class="identifier">Object</span>
) <span class="keyword">As</span> <span class="identifier">HRESULT</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">pwcsName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTE2633870_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />A pointer to the path of the null-terminated Unicode string file that contains the storage object. This string size cannot exceed MAX_PATH characters.
            <p>Windows Server 2003 and Windows XP/2000:  Unlike the CreateFile function, the MAX_PATH limit cannot be exceeded by using the "\\?\" prefix.</p></dd><dt><span class="parameter">grfMode</span></dt><dd>Type: <a href="ed3a09b2-f303-472a-af02-2c98bfbb263b.htm">Vanara.PInvoke<span id="LSTE2633870_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>STGM</a><br />A value that specifies the access mode to open the new storage object. For more information, see STGM Constants. If the caller specifies transacted mode together with STGM_CREATE or STGM_CONVERT, the overwrite or conversion occurs when the commit operation is called for the root storage. If IStorage::Commit is not called for the root storage object, previous contents of the file will be restored. STGM_CREATE and STGM_CONVERT cannot be combined with the STGM_NOSNAPSHOT flag, because a snapshot copy is required when a file is overwritten or converted in transacted mode.
            <p>If the storage object is opened in direct mode(STGM_DIRECT) with access to either STGM_WRITE or STGM_READWRITE, the sharing mode must be STGM_SHARE_EXCLUSIVE unless the STGM_DIRECT_SWMR mode is specified.For more information, see the Remarks section.If the storage object is opened in direct mode with access to STGM_READ, the sharing mode must be either STGM_SHARE_EXCLUSIVE or STGM_SHARE_DENY_WRITE, unless STGM_PRIORITY or STGM_DIRECT_SWMR is specified.For more information, see the Remarks section.</p><p>The mode in which a file is opened can affect implementation performance.For more information, see Compound File Implementation Limits.</p></dd><dt><span class="parameter">stgfmt</span></dt><dd>Type: <a href="94e9a4c1-1df3-a430-bdf3-f57f3d9463bf.htm">Vanara.PInvoke<span id="LSTE2633870_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Ole32<span id="LSTE2633870_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>STGFMT</a><br />A value that specifies the storage file format. For more information, see the STGFMT enumeration.</dd><dt><span class="parameter">grfAttrs</span></dt><dd>Type: <a href="95768a75-9990-7529-ec62-9e952321ddcc.htm">Vanara.PInvoke<span id="LSTE2633870_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FileFlagsAndAttributes</a><br />A value that depends upon the value of the stgfmt parameter. STGFMT_DOCFILE must be zero (0) or FILE_FLAG_NO_BUFFERING. For more information about this value, see CreateFile. If the sector size of the file, specified in pStgOptions, is not an integer multiple of the physical sector size of the underlying disk, then this operation will fail. All other values of stgfmt must be zero.</dd><dt><span class="parameter">pStgOptions</span></dt><dd>Type: <a href="fc067561-fd3b-3d86-a64d-2f516bb0e772.htm">Vanara.PInvoke<span id="LSTE2633870_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Ole32<span id="LSTE2633870_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>STGOPTIONS</a><span id="LSTE2633870_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_12?cpp=%");</script><br />A pointer to an STGOPTIONS structure that contains data about the storage object opened. The pStgOptions parameter is valid only if the stgfmt parameter is set to STGFMT_DOCFILE. The usVersion member must be set before calling StgOpenStorageEx. For more information, see the STGOPTIONS structure.</dd><dt><span class="parameter">reserved2</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LSTE2633870_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><br />Reserved; must be zero.</dd><dt><span class="parameter">riid</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/cey1zx63" target="_blank">System<span id="LSTE2633870_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_14?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Guid</a><br />A value that specifies the GUID of the interface pointer to return. Can also be the header-specified value for IID_IStorage to obtain the IStorage interface or for IID_IPropertySetStorage to obtain the IPropertySetStorage interface.</dd><dt><span class="parameter">ppObjectOpen</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LSTE2633870_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_15?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><span id="LSTE2633870_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE2633870_16?cpp=%");</script><br />The address of an interface pointer variable that receives a pointer for an interface on the storage object opened; contains NULL if operation failed.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="b6fb8f7d-a892-011d-4d7f-4b60a53a0104.htm">HRESULT</a><br />This function can also return any file system errors or system errors wrapped in an HRESULT. For more information, see Error Handling Strategies and Handling Unknown Errors.</div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="34191c95-a05e-a3a2-0f94-c72e121807f5.htm">Ole32 Class</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>