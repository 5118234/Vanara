<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Kernel32.GetVolumeInformation Method (String, StringBuilder, Int32, UInt32, UInt32, Kernel32.FileSystemFlags, StringBuilder, Int32)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.Kernel32.GetVolumeInformation(System.String,System.Text.StringBuilder,System.Int32,System.UInt32@,System.UInt32@,Vanara.PInvoke.Kernel32.FileSystemFlags@,System.Text.StringBuilder,System.Int32)" /><meta name="Description" content="Retrieves information about the file system and volume associated with the specified root directory." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="d72d81ce-c500-ab95-f0e0-53568e0ec6f7" /><meta name="guid" content="d72d81ce-c500-ab95-f0e0-53568e0ec6f7" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="44c5555c-a81e-30f0-1ed7-2f42856e9dd3.htm" title="Kernel32 Class" tocid="44c5555c-a81e-30f0-1ed7-2f42856e9dd3">Kernel32 Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="e0c356d3-afb6-0755-9784-8a8838aa400f.htm" title="Kernel32 Methods" tocid="e0c356d3-afb6-0755-9784-8a8838aa400f">Kernel32 Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="2f28c79b-ef80-5ad8-fb0f-917a426779f2.htm" title="GetVolumeInformation Method " tocid="2f28c79b-ef80-5ad8-fb0f-917a426779f2">GetVolumeInformation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="54747f3e-8c9c-1117-0eb4-f31bbe48de70.htm" title="GetVolumeInformation Method (String, String, UInt32, UInt32, Kernel32.FileSystemFlags, String)" tocid="54747f3e-8c9c-1117-0eb4-f31bbe48de70">GetVolumeInformation Method (String, String, UInt32, UInt32, Kernel32.FileSystemFlags, String)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="d72d81ce-c500-ab95-f0e0-53568e0ec6f7.htm" title="GetVolumeInformation Method (String, StringBuilder, Int32, UInt32, UInt32, Kernel32.FileSystemFlags, StringBuilder, Int32)" tocid="d72d81ce-c500-ab95-f0e0-53568e0ec6f7">GetVolumeInformation Method (String, StringBuilder, Int32, UInt32, UInt32, Kernel32.FileSystemFlags, StringBuilder, Int32)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Kernel32<span id="LST3B44D39F_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_0?cpp=::|nu=.");</script>GetVolumeInformation Method (String, StringBuilder, Int32, UInt32<span id="LST3B44D39F_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_1?cpp=%");</script>, UInt32<span id="LST3B44D39F_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_2?cpp=%");</script>, Kernel32<span id="LST3B44D39F_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_3?cpp=::|nu=.");</script>FileSystemFlags<span id="LST3B44D39F_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_4?cpp=%");</script>, StringBuilder, Int32)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">Retrieves information about the file system and volume associated with the specified root directory.</div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.Kernel32 (in Vanara.PInvoke.Kernel32.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">bool</span> <span class="identifier">GetVolumeInformation</span>(
	<span class="identifier">string</span> <span class="parameter">lpRootPathName</span>,
	<span class="identifier">StringBuilder</span> <span class="parameter">lpVolumeNameBuffer</span>,
	<span class="identifier">int</span> <span class="parameter">nVolumeNameSize</span>,
	<span class="keyword">ref</span> <span class="identifier">uint</span> <span class="parameter">lpVolumeSerialNumber</span>,
	<span class="keyword">ref</span> <span class="identifier">uint</span> <span class="parameter">lpMaximumComponentLength</span>,
	<span class="keyword">ref</span> <span class="identifier">Kernel32<span id="LST3B44D39F_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FileSystemFlags</span> <span class="parameter">lpFileSystemFlags</span>,
	<span class="identifier">StringBuilder</span> <span class="parameter">lpFileSystemNameBuffer</span>,
	<span class="identifier">int</span> <span class="parameter">nFileSystemNameSize</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">GetVolumeInformation</span> ( 
	<span class="parameter">lpRootPathName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">lpVolumeNameBuffer</span> <span class="keyword">As</span> <span class="identifier">StringBuilder</span>,
	<span class="parameter">nVolumeNameSize</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="keyword">ByRef</span> <span class="parameter">lpVolumeSerialNumber</span> <span class="keyword">As</span> <span class="identifier">UInteger</span>,
	<span class="keyword">ByRef</span> <span class="parameter">lpMaximumComponentLength</span> <span class="keyword">As</span> <span class="identifier">UInteger</span>,
	<span class="keyword">ByRef</span> <span class="parameter">lpFileSystemFlags</span> <span class="keyword">As</span> <span class="identifier">Kernel32<span id="LST3B44D39F_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FileSystemFlags</span>,
	<span class="parameter">lpFileSystemNameBuffer</span> <span class="keyword">As</span> <span class="identifier">StringBuilder</span>,
	<span class="parameter">nFileSystemNameSize</span> <span class="keyword">As</span> <span class="identifier">Integer</span>
) <span class="keyword">As</span> <span class="identifier">Boolean</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">lpRootPathName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST3B44D39F_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
            A pointer to a string that contains the root directory of the volume to be described.
            <p>
            If this parameter is NULL, the root of the current directory is used. A trailing backslash is required. For example, you specify \\MyServer\MyShare
            as "\\MyServer\MyShare\", or the C drive as "C:\".
            </p></dd><dt><span class="parameter">lpVolumeNameBuffer</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/y9sxk6fy" target="_blank">System.Text<span id="LST3B44D39F_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>StringBuilder</a><br />
            A pointer to a buffer that receives the name of a specified volume. The buffer size is specified by the <span class="parameter">nVolumeNameSize</span> parameter.
            </dd><dt><span class="parameter">nVolumeNameSize</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST3B44D39F_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />
            The length of a volume name buffer, in TCHARs. The maximum buffer size is MAX_PATH+1.
            <p>This parameter is ignored if the volume name buffer is not supplied.</p></dd><dt><span class="parameter">lpVolumeSerialNumber</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">System<span id="LST3B44D39F_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt32</a><span id="LST3B44D39F_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_11?cpp=%");</script><br />
            A pointer to a variable that receives the volume serial number.
            <p>This parameter can be NULL if the serial number is not required.</p><p>
            This function returns the volume serial number that the operating system assigns when a hard disk is formatted. To programmatically obtain the hard
            disk's serial number that the manufacturer assigns, use the Windows Management Instrumentation (WMI) Win32_PhysicalMedia property SerialNumber.
            </p></dd><dt><span class="parameter">lpMaximumComponentLength</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">System<span id="LST3B44D39F_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt32</a><span id="LST3B44D39F_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_13?cpp=%");</script><br />
            A pointer to a variable that receives the maximum length, in TCHARs, of a file name component that a specified file system supports.
            <p>A file name component is the portion of a file name between backslashes.</p><p>
            The value that is stored in the variable that <span class="parameter">lpMaximumComponentLength</span> points to is used to indicate that a specified file system
            supports long names. For example, for a FAT file system that supports long names, the function stores the value 255, rather than the previous 8.3
            indicator. Long names can also be supported on systems that use the NTFS file system.
            </p></dd><dt><span class="parameter">lpFileSystemFlags</span></dt><dd>Type: <a href="ba371bf2-d8d2-4c09-d03c-970bf8d2467c.htm">Vanara.PInvoke<span id="LST3B44D39F_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_14?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Kernel32<span id="LST3B44D39F_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_15?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FileSystemFlags</a><span id="LST3B44D39F_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_16?cpp=%");</script><br />
            A pointer to a variable that receives flags associated with the specified file system.
            <p>
            This parameter can be one or more of the <a href="ba371bf2-d8d2-4c09-d03c-970bf8d2467c.htm">Kernel32<span id="LST3B44D39F_17"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_17?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FileSystemFlags</a> values. However, FILE_FILE_COMPRESSION and FILE_VOL_IS_COMPRESSED are mutually exclusive.
            </p></dd><dt><span class="parameter">lpFileSystemNameBuffer</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/y9sxk6fy" target="_blank">System.Text<span id="LST3B44D39F_18"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_18?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>StringBuilder</a><br />
            A pointer to a buffer that receives the name of the file system, for example, the FAT file system or the NTFS file system. The buffer size is
            specified by the <span class="parameter">nFileSystemNameSize</span> parameter.
            </dd><dt><span class="parameter">nFileSystemNameSize</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST3B44D39F_19"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST3B44D39F_19?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />
            The length of the file system name buffer, in TCHARs. The maximum buffer size is MAX_PATH+1.
            <p>This parameter is ignored if the file system name buffer is not supplied.</p></dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">Boolean</a><br />
            If all the requested information is retrieved, the return value is nonzero.
            <p>If not all the requested information is retrieved, the return value is zero. To get extended error information, call GetLastError.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID2RBSection" class="collapsibleSection">
            When a user attempts to get information about a floppy drive that does not have a floppy disk, or a CD-ROM drive that does not have a compact disc,
            the system displays a message box for the user to insert a floppy disk or a compact disc, respectively. To prevent the system from displaying this
            message box, call the SetErrorMode function with SEM_FAILCRITICALERRORS.
            <p>
            The FILE_VOL_IS_COMPRESSED flag is the only indicator of volume-based compression. The file system name is not altered to indicate compression, for
            example, this flag is returned set on a DoubleSpace volume. When compression is volume-based, an entire volume is compressed or not compressed.
            </p><p>
            The FILE_FILE_COMPRESSION flag indicates whether a file system supports file-based compression. When compression is file-based, individual files can
            be compressed or not compressed.
            </p><p>The FILE_FILE_COMPRESSION and FILE_VOL_IS_COMPRESSED flags are mutually exclusive. Both bits cannot be returned set.</p><p>
            The maximum component length value that is stored in lpMaximumComponentLength is the only indicator that a volume supports longer-than-normal FAT
            file system (or other file system) file names. The file system name is not altered to indicate support for long file names.
            </p><p>
            The GetCompressedFileSize function obtains the compressed size of a file. The GetFileAttributes function can determine whether an individual file is compressed.
            </p><p>Symbolic link behavior—</p><p>If the path points to a symbolic link, the function returns volume information for the target.</p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="44c5555c-a81e-30f0-1ed7-2f42856e9dd3.htm">Kernel32 Class</a></div><div class="seeAlsoStyle"><a href="2f28c79b-ef80-5ad8-fb0f-917a426779f2.htm">GetVolumeInformation Overload</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>