<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Gdi32.CreateDIBSection Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="CreateDIBSection method" /><meta name="System.Keywords" content="Gdi32.CreateDIBSection method" /><meta name="Microsoft.Help.F1" content="Vanara.PInvoke.Gdi32.CreateDIBSection" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.Gdi32.CreateDIBSection(Vanara.PInvoke.Gdi32.SafeDCHandle,Vanara.PInvoke.Gdi32.BITMAPINFO@,Vanara.PInvoke.Gdi32.DIBColorMode,System.IntPtr@,System.IntPtr,System.Int32)" /><meta name="Description" content="The CreateDIBSection function creates a DIB that applications can write to directly. The function gives you a pointer to the location of the bitmap bit values." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="00fd30ae-0227-4423-b1b8-59446ed662e7" /><meta name="guid" content="00fd30ae-0227-4423-b1b8-59446ed662e7" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="14376d8f-3136-8bb4-c86f-4fc25cf3d7ce.htm" title="Gdi32 Class" tocid="14376d8f-3136-8bb4-c86f-4fc25cf3d7ce">Gdi32 Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="de438f69-8927-4ca0-b8ab-d1cc5ba75432.htm" title="Gdi32 Methods" tocid="de438f69-8927-4ca0-b8ab-d1cc5ba75432">Gdi32 Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="e8e557c0-c21f-4162-5cbd-b92c99042888.htm" title="AlphaBlend Method " tocid="e8e557c0-c21f-4162-5cbd-b92c99042888">AlphaBlend Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="acd130b9-d1f7-01ab-077e-55bd50151972.htm" title="BitBlt Method " tocid="acd130b9-d1f7-01ab-077e-55bd50151972">BitBlt Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="819bbfcd-5464-ef82-13d7-8d3bc4ccb1bd.htm" title="CreateCompatibleDC Method " tocid="819bbfcd-5464-ef82-13d7-8d3bc4ccb1bd">CreateCompatibleDC Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="00fd30ae-0227-4423-b1b8-59446ed662e7.htm" title="CreateDIBSection Method " tocid="00fd30ae-0227-4423-b1b8-59446ed662e7">CreateDIBSection Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="8eeec57b-4914-37be-3913-035816643bae.htm" title="DeleteDC Method " tocid="8eeec57b-4914-37be-3913-035816643bae">DeleteDC Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="cd832b65-2b16-d470-3617-5dba6ef2dddc.htm" title="DeleteObject Method " tocid="cd832b65-2b16-d470-3617-5dba6ef2dddc">DeleteObject Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="af6698b9-109a-d9fe-19fa-0f0dc35c216e.htm" title="GdiFlush Method " tocid="af6698b9-109a-d9fe-19fa-0f0dc35c216e">GdiFlush Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="2353acb4-4769-ba4c-93e7-7ee80175862d.htm" title="GetDIBits Method " tocid="2353acb4-4769-ba4c-93e7-7ee80175862d">GetDIBits Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="a7517cb9-4317-1f27-caaf-66de476944d5.htm" title="GetObject Method " tocid="a7517cb9-4317-1f27-caaf-66de476944d5">GetObject Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="7efe5c20-f302-6d83-b86e-69b8f6dd0426.htm" title="SelectObject Method " tocid="7efe5c20-f302-6d83-b86e-69b8f6dd0426">SelectObject Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="8838a322-cff7-5fcd-b78b-9f6f7e902ffe.htm" title="SetBkMode Method " tocid="8838a322-cff7-5fcd-b78b-9f6f7e902ffe">SetBkMode Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="ff3dbcf1-ecc3-5388-380d-f5b73e1d37b3.htm" title="SetLayout Method " tocid="ff3dbcf1-ecc3-5388-380d-f5b73e1d37b3">SetLayout Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9d61a02f-5671-852e-e35b-0c5300432974.htm" title="TransparentBlt Method " tocid="9d61a02f-5671-852e-e35b-0c5300432974">TransparentBlt Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Gdi32<span id="LSTE3F2248E_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_0?cpp=::|nu=.");</script>CreateDIBSection Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            The CreateDIBSection function creates a DIB that applications can write to directly. The function gives you a pointer to the location of the bitmap
            bit values. You can supply a handle to a file-mapping object that the function will use to create the bitmap, or you can let the system allocate the
            memory for the bitmap.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.Gdi32 (in Vanara.PInvoke.Gdi32.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">IntPtr</span> <span class="identifier">CreateDIBSection</span>(
	<span class="identifier">Gdi32<span id="LSTE3F2248E_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeDCHandle</span> <span class="parameter">hdc</span>,
	<span class="keyword">ref</span> <span class="identifier">Gdi32<span id="LSTE3F2248E_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>BITMAPINFO</span> <span class="parameter">pbmi</span>,
	<span class="identifier">Gdi32<span id="LSTE3F2248E_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>DIBColorMode</span> <span class="parameter">iUsage</span>,
	<span class="keyword">out</span> <span class="identifier">IntPtr</span> <span class="parameter">ppvBits</span>,
	<span class="identifier">IntPtr</span> <span class="parameter">hSection</span>,
	<span class="identifier">int</span> <span class="parameter">dwOffset</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">CreateDIBSection</span> ( 
	<span class="parameter">hdc</span> <span class="keyword">As</span> <span class="identifier">Gdi32<span id="LSTE3F2248E_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeDCHandle</span>,
	<span class="keyword">ByRef</span> <span class="parameter">pbmi</span> <span class="keyword">As</span> <span class="identifier">Gdi32<span id="LSTE3F2248E_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>BITMAPINFO</span>,
	<span class="parameter">iUsage</span> <span class="keyword">As</span> <span class="identifier">Gdi32<span id="LSTE3F2248E_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>DIBColorMode</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">ppvBits</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">hSection</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">dwOffset</span> <span class="keyword">As</span> <span class="identifier">Integer</span>
) <span class="keyword">As</span> <span class="identifier">IntPtr</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">hdc</span></dt><dd>Type: <a href="a1c3d72a-f61c-a10a-15ee-cf17f0536893.htm">Vanara.PInvoke<span id="LSTE3F2248E_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Gdi32<span id="LSTE3F2248E_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeDCHandle</a><br />
            A handle to a device context. If the value of iUsage is DIB_PAL_COLORS, the function uses this device context's logical palette to initialize the DIB colors.
            </dd><dt><span class="parameter">pbmi</span></dt><dd>Type: <a href="d9992132-4c4f-826b-b58f-1fae9c3a763d.htm">Vanara.PInvoke<span id="LSTE3F2248E_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Gdi32<span id="LSTE3F2248E_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>BITMAPINFO</a><span id="LSTE3F2248E_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_11?cpp=%");</script><br />A pointer to a BITMAPINFO structure that specifies various attributes of the DIB, including the bitmap dimensions and colors.</dd><dt><span class="parameter">iUsage</span></dt><dd>Type: <a href="1c198aac-fdd4-d001-1fe2-ac3123802df9.htm">Vanara.PInvoke<span id="LSTE3F2248E_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Gdi32<span id="LSTE3F2248E_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>DIBColorMode</a><br />
            The type of data contained in the bmiColors array member of the BITMAPINFO structure pointed to by pbmi (either logical palette indexes or literal
            RGB values).
            </dd><dt><span class="parameter">ppvBits</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LSTE3F2248E_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_14?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><span id="LSTE3F2248E_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_15?cpp=%");</script><br />A pointer to a variable that receives a pointer to the location of the DIB bit values.</dd><dt><span class="parameter">hSection</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LSTE3F2248E_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_16?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><br />
            A handle to a file-mapping object that the function will use to create the DIB. This parameter can be NULL.
            <p>
            If hSection is not NULL, it must be a handle to a file-mapping object created by calling the CreateFileMapping function with the PAGE_READWRITE or
            PAGE_WRITECOPY flag. Read-only DIB sections are not supported. Handles created by other means will cause CreateDIBSection to fail.
            </p><p>
            If hSection is not NULL, the CreateDIBSection function locates the bitmap bit values at offset dwOffset in the file-mapping object referred to by
            hSection. An application can later retrieve the hSection handle by calling the GetObject function with the HBITMAP returned by CreateDIBSection.
            </p><p>
            If hSection is NULL, the system allocates memory for the DIB. In this case, the CreateDIBSection function ignores the dwOffset parameter. An
            application cannot later obtain a handle to this memory. The dshSection member of the DIBSECTION structure filled in by calling the GetObject
            function will be NULL.
            </p></dd><dt><span class="parameter">dwOffset</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LSTE3F2248E_17"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTE3F2248E_17?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />
            The offset from the beginning of the file-mapping object referenced by hSection where storage for the bitmap bit values is to begin. This value is
            ignored if hSection is NULL. The bitmap bit values are aligned on doubleword boundaries, so dwOffset must be a multiple of the size of a DWORD.
            </dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">IntPtr</a><br />
            If the function succeeds, the return value is a handle to the newly created DIB, and *ppvBits points to the bitmap bit values.
            <p>If the function fails, the return value is NULL, and *ppvBits is NULL.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID2RBSection" class="collapsibleSection">
            As noted above, if hSection is NULL, the system allocates memory for the DIB. The system closes the handle to that memory when you later delete the
            DIB by calling the DeleteObject function. If hSection is not NULL, you must close the hSection memory handle yourself after calling DeleteObject to
            delete the bitmap.
            <p>You cannot paste a DIB section from one application into another application.</p><p>
            CreateDIBSection does not use the BITMAPINFOHEADER parameters biXPelsPerMeter or biYPelsPerMeter and will not provide resolution information in the
            BITMAPINFO structure.
            </p><p>
            You need to guarantee that the GDI subsystem has completed any drawing to a bitmap created by CreateDIBSection before you draw to the bitmap
            yourself. Access to the bitmap must be synchronized. Do this by calling the GdiFlush function. This applies to any use of the pointer to the bitmap
            bit values, including passing the pointer in calls to functions such as SetDIBits.
            </p><p>ICM: No color management is done.</p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="14376d8f-3136-8bb4-c86f-4fc25cf3d7ce.htm">Gdi32 Class</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>