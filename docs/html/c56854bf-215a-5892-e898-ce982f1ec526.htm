<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AdvApi32.LookupAccountName Method (String, String, AdvApi32.PSID, String, AdvApi32.SID_NAME_USE)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.AdvApi32.LookupAccountName(System.String,System.String,Vanara.PInvoke.AdvApi32.PSID@,System.String@,Vanara.PInvoke.AdvApi32.SID_NAME_USE@)" /><meta name="Description" content="The LookupAccountName function accepts the name of a system and an account as input. It retrieves a security identifier (SID) for the account and the name of the domain on which the account was found." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="c56854bf-215a-5892-e898-ce982f1ec526" /><meta name="guid" content="c56854bf-215a-5892-e898-ce982f1ec526" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="9e2975d6-cd80-a5d1-8428-fefbd08eac87.htm" title="AdvApi32 Class" tocid="9e2975d6-cd80-a5d1-8428-fefbd08eac87">AdvApi32 Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="7f8c165a-260f-d23f-8357-ee127065012d.htm" title="AdvApi32 Methods" tocid="7f8c165a-260f-d23f-8357-ee127065012d">AdvApi32 Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="394fac26-cac6-e1db-43f7-af0044b2f456.htm" title="LookupAccountName Method " tocid="394fac26-cac6-e1db-43f7-af0044b2f456">LookupAccountName Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="c56854bf-215a-5892-e898-ce982f1ec526.htm" title="LookupAccountName Method (String, String, AdvApi32.PSID, String, AdvApi32.SID_NAME_USE)" tocid="c56854bf-215a-5892-e898-ce982f1ec526">LookupAccountName Method (String, String, AdvApi32.PSID, String, AdvApi32.SID_NAME_USE)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="6643b234-265e-2410-8e57-c4ca5980efe5.htm" title="LookupAccountName Method (String, String, AdvApi32.PSID, Int32, StringBuilder, Int32, AdvApi32.SID_NAME_USE)" tocid="6643b234-265e-2410-8e57-c4ca5980efe5">LookupAccountName Method (String, String, AdvApi32.PSID, Int32, StringBuilder, Int32, AdvApi32.SID_NAME_USE)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>AdvApi32<span id="LST31274F7C_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_0?cpp=::|nu=.");</script>LookupAccountName Method (String, String, AdvApi32<span id="LST31274F7C_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_1?cpp=::|nu=.");</script>PSID<span id="LST31274F7C_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_2?cpp=%");</script>, String<span id="LST31274F7C_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_3?cpp=%");</script>, AdvApi32<span id="LST31274F7C_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_4?cpp=::|nu=.");</script>SID_NAME_USE<span id="LST31274F7C_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_5?cpp=%");</script>)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            The LookupAccountName function accepts the name of a system and an account as input. It retrieves a security identifier (SID) for the account and the
            name of the domain on which the account was found.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.Security (in Vanara.PInvoke.Security.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">bool</span> <span class="identifier">LookupAccountName</span>(
	<span class="identifier">string</span> <span class="parameter">systemName</span>,
	<span class="identifier">string</span> <span class="parameter">accountName</span>,
	<span class="keyword">out</span> <span class="identifier">AdvApi32<span id="LST31274F7C_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>PSID</span> <span class="parameter">sid</span>,
	<span class="keyword">out</span> <span class="identifier">string</span> <span class="parameter">domainName</span>,
	<span class="keyword">out</span> <span class="identifier">AdvApi32<span id="LST31274F7C_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SID_NAME_USE</span> <span class="parameter">snu</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">LookupAccountName</span> ( 
	<span class="parameter">systemName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">accountName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">sid</span> <span class="keyword">As</span> <span class="identifier">AdvApi32<span id="LST31274F7C_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>PSID</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">domainName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">snu</span> <span class="keyword">As</span> <span class="identifier">AdvApi32<span id="LST31274F7C_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SID_NAME_USE</span>
) <span class="keyword">As</span> <span class="identifier">Boolean</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">systemName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST31274F7C_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
            A string that specifies the name of the system. This string can be the name of a remote computer. If this string is NULL, the account name
            translation begins on the local system. If the name cannot be resolved on the local system, this function will try to resolve the name using domain
            controllers trusted by the local system. Generally, specify a value for lpSystemName only when the account is in an untrusted domain and the name of
            a computer in that domain is known.
            </dd><dt><span class="parameter">accountName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST31274F7C_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
            A string that specifies the account name.
            <p>Use a fully qualified string in the domain_name\user_name format to ensure that LookupAccountName finds the account in the desired domain.</p></dd><dt><span class="parameter">sid</span></dt><dd>Type: <a href="2dfeb9c1-df86-3f78-b2d2-eff0a9c0cee5.htm">Vanara.PInvoke<span id="LST31274F7C_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AdvApi32<span id="LST31274F7C_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>PSID</a><span id="LST31274F7C_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_14?cpp=%");</script><br />A PSID class that corresponds to the account name pointed to by the lpAccountName parameter.</dd><dt><span class="parameter">domainName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST31274F7C_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_15?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><span id="LST31274F7C_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_16?cpp=%");</script><br />
            A string that receives the name of the domain where the account name is found. For computers that are not joined to a domain, this buffer receives
            the computer name.
            </dd><dt><span class="parameter">snu</span></dt><dd>Type: <a href="8177a908-85da-1187-77e6-ca60f0d85272.htm">Vanara.PInvoke<span id="LST31274F7C_17"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_17?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AdvApi32<span id="LST31274F7C_18"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_18?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SID_NAME_USE</a><span id="LST31274F7C_19"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST31274F7C_19?cpp=%");</script><br />A SID_NAME_USE enumerated type that indicates the type of the account when the function returns.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">Boolean</a><br />
            If the function succeeds, the function returns nonzero. If the function fails, it returns zero. For extended error information, call GetLastError.
            </div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="9e2975d6-cd80-a5d1-8428-fefbd08eac87.htm">AdvApi32 Class</a></div><div class="seeAlsoStyle"><a href="394fac26-cac6-e1db-43f7-af0044b2f456.htm">LookupAccountName Overload</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>