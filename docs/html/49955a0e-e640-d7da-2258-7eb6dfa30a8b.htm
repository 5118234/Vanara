<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Gdi32.GetDIBits Method (Gdi32.SafeDCHandle, IntPtr, Int32, Int32, IntPtr, Gdi32.BITMAPINFO, Gdi32.DIBColorMode)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.Gdi32.GetDIBits(Vanara.PInvoke.Gdi32.SafeDCHandle,System.IntPtr,System.Int32,System.Int32,System.IntPtr,Vanara.PInvoke.Gdi32.BITMAPINFO@,Vanara.PInvoke.Gdi32.DIBColorMode)" /><meta name="Description" content="The GetDIBits function retrieves the bits of the specified compatible bitmap and copies them into a buffer as a DIB using the specified format." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="49955a0e-e640-d7da-2258-7eb6dfa30a8b" /><meta name="guid" content="49955a0e-e640-d7da-2258-7eb6dfa30a8b" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="14376d8f-3136-8bb4-c86f-4fc25cf3d7ce.htm" title="Gdi32 Class" tocid="14376d8f-3136-8bb4-c86f-4fc25cf3d7ce">Gdi32 Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="de438f69-8927-4ca0-b8ab-d1cc5ba75432.htm" title="Gdi32 Methods" tocid="de438f69-8927-4ca0-b8ab-d1cc5ba75432">Gdi32 Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="2353acb4-4769-ba4c-93e7-7ee80175862d.htm" title="GetDIBits Method " tocid="2353acb4-4769-ba4c-93e7-7ee80175862d">GetDIBits Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="1284e171-cefc-f1eb-835c-b195aa9d62bd.htm" title="GetDIBits Method (Gdi32.SafeDCHandle, IntPtr, Int32, Int32, Byte[], Gdi32.BITMAPINFO, Gdi32.DIBColorMode)" tocid="1284e171-cefc-f1eb-835c-b195aa9d62bd">GetDIBits Method (Gdi32.SafeDCHandle, IntPtr, Int32, Int32, Byte[], Gdi32.BITMAPINFO, Gdi32.DIBColorMode)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="49955a0e-e640-d7da-2258-7eb6dfa30a8b.htm" title="GetDIBits Method (Gdi32.SafeDCHandle, IntPtr, Int32, Int32, IntPtr, Gdi32.BITMAPINFO, Gdi32.DIBColorMode)" tocid="49955a0e-e640-d7da-2258-7eb6dfa30a8b">GetDIBits Method (Gdi32.SafeDCHandle, IntPtr, Int32, Int32, IntPtr, Gdi32.BITMAPINFO, Gdi32.DIBColorMode)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Gdi32<span id="LST8D4801DB_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_0?cpp=::|nu=.");</script>GetDIBits Method (Gdi32<span id="LST8D4801DB_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_1?cpp=::|nu=.");</script>SafeDCHandle, IntPtr, Int32, Int32, IntPtr, Gdi32<span id="LST8D4801DB_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_2?cpp=::|nu=.");</script>BITMAPINFO<span id="LST8D4801DB_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_3?cpp=%");</script>, Gdi32<span id="LST8D4801DB_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_4?cpp=::|nu=.");</script>DIBColorMode)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            The GetDIBits function retrieves the bits of the specified compatible bitmap and copies them into a buffer as a DIB using the specified format.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.Gdi32 (in Vanara.PInvoke.Gdi32.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">int</span> <span class="identifier">GetDIBits</span>(
	<span class="identifier">Gdi32<span id="LST8D4801DB_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeDCHandle</span> <span class="parameter">hdc</span>,
	<span class="identifier">IntPtr</span> <span class="parameter">hbmp</span>,
	<span class="identifier">int</span> <span class="parameter">uStartScan</span>,
	<span class="identifier">int</span> <span class="parameter">cScanLines</span>,
	<span class="identifier">IntPtr</span> <span class="parameter">lpvBits</span>,
	<span class="keyword">ref</span> <span class="identifier">Gdi32<span id="LST8D4801DB_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>BITMAPINFO</span> <span class="parameter">lpbi</span>,
	<span class="identifier">Gdi32<span id="LST8D4801DB_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>DIBColorMode</span> <span class="parameter">uUsage</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">GetDIBits</span> ( 
	<span class="parameter">hdc</span> <span class="keyword">As</span> <span class="identifier">Gdi32<span id="LST8D4801DB_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeDCHandle</span>,
	<span class="parameter">hbmp</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">uStartScan</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">cScanLines</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">lpvBits</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="keyword">ByRef</span> <span class="parameter">lpbi</span> <span class="keyword">As</span> <span class="identifier">Gdi32<span id="LST8D4801DB_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>BITMAPINFO</span>,
	<span class="parameter">uUsage</span> <span class="keyword">As</span> <span class="identifier">Gdi32<span id="LST8D4801DB_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>DIBColorMode</span>
) <span class="keyword">As</span> <span class="identifier">Integer</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">hdc</span></dt><dd>Type: <a href="a1c3d72a-f61c-a10a-15ee-cf17f0536893.htm">Vanara.PInvoke<span id="LST8D4801DB_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Gdi32<span id="LST8D4801DB_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeDCHandle</a><br />A handle to the device context.</dd><dt><span class="parameter">hbmp</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LST8D4801DB_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><br />A handle to the bitmap. This must be a compatible bitmap (DDB).</dd><dt><span class="parameter">uStartScan</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST8D4801DB_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_14?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />The first scan line to retrieve.</dd><dt><span class="parameter">cScanLines</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST8D4801DB_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_15?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />The number of scan lines to retrieve.</dd><dt><span class="parameter">lpvBits</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LST8D4801DB_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_16?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><br />
            A pointer to a buffer to receive the bitmap data. If this parameter is NULL, the function passes the dimensions and format of the bitmap to the
            BITMAPINFO structure pointed to by the lpbi parameter.
            </dd><dt><span class="parameter">lpbi</span></dt><dd>Type: <a href="d9992132-4c4f-826b-b58f-1fae9c3a763d.htm">Vanara.PInvoke<span id="LST8D4801DB_17"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_17?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Gdi32<span id="LST8D4801DB_18"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_18?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>BITMAPINFO</a><span id="LST8D4801DB_19"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_19?cpp=%");</script><br />A pointer to a BITMAPINFO structure that specifies the desired format for the DIB data.</dd><dt><span class="parameter">uUsage</span></dt><dd>Type: <a href="1c198aac-fdd4-d001-1fe2-ac3123802df9.htm">Vanara.PInvoke<span id="LST8D4801DB_20"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_20?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Gdi32<span id="LST8D4801DB_21"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8D4801DB_21?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>DIBColorMode</a><br />The format of the bmiColors member of the BITMAPINFO structure.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Int32</a><br />
            If the lpvBits parameter is non-NULL and the function succeeds, the return value is the number of scan lines copied from the bitmap.
            <p>If the lpvBits parameter is NULL and GetDIBits successfully fills the BITMAPINFO structure, the return value is nonzero.</p><p>If the function fails, the return value is zero.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID2RBSection" class="collapsibleSection">
            If the requested format for the DIB matches its internal format, the RGB values for the bitmap are copied. If the requested format doesn't match the
            internal format, a color table is synthesized. The following table describes the color table synthesized for each format.
            <div class="tableSection"><table><tr><th>Value</th><th>Meaning</th></tr><tr><td>1_BPP</td><td>The color table consists of a black and a white entry.</td></tr><tr><td>4_BPP</td><td>The color table consists of a mix of colors identical to the standard VGA palette.</td></tr><tr><td>8_BPP</td><td>
            The color table consists of a general mix of 256 colors defined by GDI. (Included in these 256 colors are the 20 colors found in the default logical palette.)
            </td></tr><tr><td>24_BPP</td><td>No color table is returned.</td></tr></table></div><p>
            If the lpvBits parameter is a valid pointer, the first six members of the BITMAPINFOHEADER structure must be initialized to specify the size and
            format of the DIB. The scan lines must be aligned on a DWORD except for RLE compressed bitmaps.
            </p><p>
            A bottom-up DIB is specified by setting the height to a positive number, while a top-down DIB is specified by setting the height to a negative
            number. The bitmap color table will be appended to the BITMAPINFO structure.
            </p><p>
            If lpvBits is NULL, GetDIBits examines the first member of the first structure pointed to by lpbi. This member must specify the size, in bytes, of a
            BITMAPCOREHEADER or a BITMAPINFOHEADER structure. The function uses the specified size to determine how the remaining members should be initialized.
            </p><p>
            If lpvBits is NULL and the bit count member of BITMAPINFO is initialized to zero, GetDIBits fills in a BITMAPINFOHEADER structure or BITMAPCOREHEADER
            without the color table. This technique can be used to query bitmap attributes.
            </p><p>The bitmap identified by the hbmp parameter must not be selected into a device context when the application calls this function.</p><p>The origin for a bottom-up DIB is the lower-left corner of the bitmap; the origin for a top-down DIB is the upper-left corner.</p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="14376d8f-3136-8bb4-c86f-4fc25cf3d7ce.htm">Gdi32 Class</a></div><div class="seeAlsoStyle"><a href="2353acb4-4769-ba4c-93e7-7ee80175862d.htm">GetDIBits Overload</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>