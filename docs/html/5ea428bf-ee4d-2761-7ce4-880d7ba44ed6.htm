<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AdvApi32.LsaLookupNames2 Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="LsaLookupNames2 method" /><meta name="System.Keywords" content="AdvApi32.LsaLookupNames2 method" /><meta name="Microsoft.Help.F1" content="Vanara.PInvoke.AdvApi32.LsaLookupNames2" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.AdvApi32.LsaLookupNames2(Vanara.PInvoke.AdvApi32.SafeLsaPolicyHandle,Vanara.PInvoke.AdvApi32.LsaLookupNamesFlags,System.UInt32,System.String[],Vanara.PInvoke.AdvApi32.SafeLsaMemoryHandle@,Vanara.PInvoke.AdvApi32.SafeLsaMemoryHandle@)" /><meta name="Description" content="The LsaLookupNames2 function retrieves the security identifiers (SIDs) for specified account names. LsaLookupNames2 can look up the SID for any account in any domain in a Windows forest." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="5ea428bf-ee4d-2761-7ce4-880d7ba44ed6" /><meta name="guid" content="5ea428bf-ee4d-2761-7ce4-880d7ba44ed6" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="9e2975d6-cd80-a5d1-8428-fefbd08eac87.htm" title="AdvApi32 Class" tocid="9e2975d6-cd80-a5d1-8428-fefbd08eac87">AdvApi32 Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="7f8c165a-260f-d23f-8357-ee127065012d.htm" title="AdvApi32 Methods" tocid="7f8c165a-260f-d23f-8357-ee127065012d">AdvApi32 Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="b0574e92-17be-504d-ec02-32105c90af42.htm" title="AbortSystemShutdown Method " tocid="b0574e92-17be-504d-ec02-32105c90af42">AbortSystemShutdown Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="b3a9c632-05f1-a886-2020-6bb6dc002b85.htm" title="AdjustTokenPrivileges Method " tocid="b3a9c632-05f1-a886-2020-6bb6dc002b85">AdjustTokenPrivileges Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="c2a909d8-fa74-1fb9-4d9a-ab975e22e7a9.htm" title="AllocateAndInitializeSid Method " tocid="c2a909d8-fa74-1fb9-4d9a-ab975e22e7a9">AllocateAndInitializeSid Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="765dfa36-6cbd-e05e-dbf7-a0d3495ef618.htm" title="AllocateLocallyUniqueId Method " tocid="765dfa36-6cbd-e05e-dbf7-a0d3495ef618">AllocateLocallyUniqueId Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d225985f-b2f0-3867-2b3f-4d37cc9b5223.htm" title="ChangeServiceConfig Method " tocid="d225985f-b2f0-3867-2b3f-4d37cc9b5223">ChangeServiceConfig Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="f241ca3a-df0a-520c-2d52-1efa3114723c.htm" title="ChangeServiceConfig2 Method " tocid="f241ca3a-df0a-520c-2d52-1efa3114723c">ChangeServiceConfig2 Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="75fdc094-1202-7d88-7c71-6551fbbfc4e2.htm" title="ConvertSecurityDescriptorToStringSecurityDescriptor Method " tocid="75fdc094-1202-7d88-7c71-6551fbbfc4e2">ConvertSecurityDescriptorToStringSecurityDescriptor Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="f6885b39-b66b-eb22-9556-3b02a921f9b0.htm" title="ConvertSidToStringSid Method " tocid="f6885b39-b66b-eb22-9556-3b02a921f9b0">ConvertSidToStringSid Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="3ad614f4-8131-d672-2b98-794ce66d2ff6.htm" title="ConvertStringSecurityDescriptorToSecurityDescriptor Method " tocid="3ad614f4-8131-d672-2b98-794ce66d2ff6">ConvertStringSecurityDescriptorToSecurityDescriptor Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="a9efcb06-f8cc-57f8-d167-6ff6bf374ac3.htm" title="ConvertStringSidToSid Method " tocid="a9efcb06-f8cc-57f8-d167-6ff6bf374ac3">ConvertStringSidToSid Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="dc80d92e-7409-ff8d-c6e8-927bc23a97b1.htm" title="CopySid Method " tocid="dc80d92e-7409-ff8d-c6e8-927bc23a97b1">CopySid Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="47ef910f-7165-547c-2b20-b809e1f46b16.htm" title="CredFree Method " tocid="47ef910f-7165-547c-2b20-b809e1f46b16">CredFree Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="b0dbb145-7eff-da98-a013-ab666f0af145.htm" title="CredGetTargetInfo Method " tocid="b0dbb145-7eff-da98-a013-ab666f0af145">CredGetTargetInfo Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="10051c51-d122-d2cb-1bc3-8558e68bd1eb.htm" title="CredReadDomainCredentials Method " tocid="10051c51-d122-d2cb-1bc3-8558e68bd1eb">CredReadDomainCredentials Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="45cfbc5f-1bb7-c1d8-a7a7-c7578c313009.htm" title="CredWriteDomainCredentials Method " tocid="45cfbc5f-1bb7-c1d8-a7a7-c7578c313009">CredWriteDomainCredentials Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d367b62f-e4da-83b1-9f08-66eec3d1f1aa.htm" title="DuplicateToken Method " tocid="d367b62f-e4da-83b1-9f08-66eec3d1f1aa">DuplicateToken Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="cbc1c424-b617-97de-f9cb-3e4af05ecb5d.htm" title="DuplicateTokenEx Method " tocid="cbc1c424-b617-97de-f9cb-3e4af05ecb5d">DuplicateTokenEx Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="2d789f67-65a9-e3ba-ca0d-2a1a3b843ce1.htm" title="EqualSid Method " tocid="2d789f67-65a9-e3ba-ca0d-2a1a3b843ce1">EqualSid Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="66353708-4abb-cc3d-4769-b557170d381c.htm" title="FreeInheritedFromArray Method " tocid="66353708-4abb-cc3d-4769-b557170d381c">FreeInheritedFromArray Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="dce44435-c0af-7e94-e0b7-1ebdbd1d9da1.htm" title="FreeSid Method " tocid="dce44435-c0af-7e94-e0b7-1ebdbd1d9da1">FreeSid Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="16fca926-fe8b-c6b7-eecd-cd1aa6625560.htm" title="GetAce Method " tocid="16fca926-fe8b-c6b7-eecd-cd1aa6625560">GetAce Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="9f1a741c-4f80-20c9-86e6-17998d4c9b3e.htm" title="GetAclInformation Method " tocid="9f1a741c-4f80-20c9-86e6-17998d4c9b3e">GetAclInformation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="24adc9a6-aa02-aa35-e1ad-19e2ae02ebc6.htm" title="GetEffectiveRightsFromAcl Method " tocid="24adc9a6-aa02-aa35-e1ad-19e2ae02ebc6">GetEffectiveRightsFromAcl Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="0da4a351-5ee7-be5a-4aff-fe7eda7fff5e.htm" title="GetInheritanceSource Method " tocid="0da4a351-5ee7-be5a-4aff-fe7eda7fff5e">GetInheritanceSource Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="8bb81668-9b32-0029-ab2f-5b1cfd73d50e.htm" title="GetLengthSid Method " tocid="8bb81668-9b32-0029-ab2f-5b1cfd73d50e">GetLengthSid Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9b6cf64c-7330-eca6-c46c-042d84722d7a.htm" title="GetNamedSecurityInfo Method " tocid="9b6cf64c-7330-eca6-c46c-042d84722d7a">GetNamedSecurityInfo Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9af48caf-ff5f-b1c3-4c84-039c487da16a.htm" title="GetPrivateObjectSecurity Method " tocid="9af48caf-ff5f-b1c3-4c84-039c487da16a">GetPrivateObjectSecurity Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="83a7f4fb-1ce2-7e9c-9f79-4841259f4251.htm" title="GetSecurityDescriptorDacl Method " tocid="83a7f4fb-1ce2-7e9c-9f79-4841259f4251">GetSecurityDescriptorDacl Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="54d723d0-2192-73fc-bf2e-7917e1f17e50.htm" title="GetSecurityDescriptorOwner Method " tocid="54d723d0-2192-73fc-bf2e-7917e1f17e50">GetSecurityDescriptorOwner Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="2c21fe5c-cb17-9ea0-b71d-4d9ad142607e.htm" title="GetSidSubAuthority Method " tocid="2c21fe5c-cb17-9ea0-b71d-4d9ad142607e">GetSidSubAuthority Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d2efbb9b-ac07-2384-7bf1-4e830edb23ee.htm" title="GetTokenInformation Method " tocid="d2efbb9b-ac07-2384-7bf1-4e830edb23ee">GetTokenInformation Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="469a16df-7db7-1fe2-34ea-0acea58fc2b7.htm" title="InitiateShutdown Method " tocid="469a16df-7db7-1fe2-34ea-0acea58fc2b7">InitiateShutdown Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="6c6c31c8-e96e-5484-aa6c-3400e2e8d771.htm" title="InitiateSystemShutdownEx Method " tocid="6c6c31c8-e96e-5484-aa6c-3400e2e8d771">InitiateSystemShutdownEx Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="775bf879-2603-588a-ab81-15a9209f2ac8.htm" title="IsValidSid Method " tocid="775bf879-2603-588a-ab81-15a9209f2ac8">IsValidSid Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d1433e33-5a2c-b870-bb7b-c0affe1a5697.htm" title="LogonUser Method " tocid="d1433e33-5a2c-b870-bb7b-c0affe1a5697">LogonUser Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="8f9f271e-e05e-893c-0dac-15b2121b535b.htm" title="LogonUserEx Method " tocid="8f9f271e-e05e-893c-0dac-15b2121b535b">LogonUserEx Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="394fac26-cac6-e1db-43f7-af0044b2f456.htm" title="LookupAccountName Method " tocid="394fac26-cac6-e1db-43f7-af0044b2f456">LookupAccountName Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="33694431-5aca-da62-2f1a-b13a536ff62d.htm" title="LookupAccountSid Method " tocid="33694431-5aca-da62-2f1a-b13a536ff62d">LookupAccountSid Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="4ecc14be-70e5-c947-a195-582d25d59803.htm" title="LookupPrivilegeName Method " tocid="4ecc14be-70e5-c947-a195-582d25d59803">LookupPrivilegeName Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d7a79688-ade2-687c-f160-bf2eea5fa552.htm" title="LookupPrivilegeValue Method " tocid="d7a79688-ade2-687c-f160-bf2eea5fa552">LookupPrivilegeValue Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="74820b01-719e-9938-43ba-027756785e37.htm" title="LsaAddAccountRights Method " tocid="74820b01-719e-9938-43ba-027756785e37">LsaAddAccountRights Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="760cf365-85c4-9abb-6840-b5fda127dc14.htm" title="LsaCreateAccount Method " tocid="760cf365-85c4-9abb-6840-b5fda127dc14">LsaCreateAccount Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="76710a55-f69a-a51e-c6ea-e477967ad406.htm" title="LsaEnumerateAccountRights Method " tocid="76710a55-f69a-a51e-c6ea-e477967ad406">LsaEnumerateAccountRights Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="afcfeff0-189d-a3e2-2dbd-64e0044e30dd.htm" title="LsaEnumerateAccountsWithUserRight Method " tocid="afcfeff0-189d-a3e2-2dbd-64e0044e30dd">LsaEnumerateAccountsWithUserRight Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="4dd283d8-f548-a8f0-65ba-f113a98cc3f0.htm" title="LsaGetAppliedCAPIDs Method " tocid="4dd283d8-f548-a8f0-65ba-f113a98cc3f0">LsaGetAppliedCAPIDs Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="c82ad43c-8947-7c0a-63bc-f74bd4139046.htm" title="LsaGetSystemAccessAccount Method " tocid="c82ad43c-8947-7c0a-63bc-f74bd4139046">LsaGetSystemAccessAccount Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="5ea428bf-ee4d-2761-7ce4-880d7ba44ed6.htm" title="LsaLookupNames2 Method " tocid="5ea428bf-ee4d-2761-7ce4-880d7ba44ed6">LsaLookupNames2 Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="a00621ad-2e07-1ef2-762c-7f6eb5f3f773.htm" title="LsaLookupSids2 Method " tocid="a00621ad-2e07-1ef2-762c-7f6eb5f3f773">LsaLookupSids2 Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9bc58a52-6ccb-ae4d-d3ff-3e088285b665.htm" title="LsaNtStatusToWinError Method " tocid="9bc58a52-6ccb-ae4d-d3ff-3e088285b665">LsaNtStatusToWinError Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="bc979132-fe21-ed84-ada6-21e7d9e8b5c3.htm" title="LsaOpenAccount Method " tocid="bc979132-fe21-ed84-ada6-21e7d9e8b5c3">LsaOpenAccount Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="b0b69bbc-45b5-e80d-8c01-25b43b304c34.htm" title="LsaOpenPolicy Method " tocid="b0b69bbc-45b5-e80d-8c01-25b43b304c34">LsaOpenPolicy Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="03c70564-5ab8-030b-be4a-5447678d57d7.htm" title="LsaRemoveAccountRights Method " tocid="03c70564-5ab8-030b-be4a-5447678d57d7">LsaRemoveAccountRights Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="7a04d623-57a9-df5f-c399-b744f2155da0.htm" title="LsaSetSystemAccessAccount Method " tocid="7a04d623-57a9-df5f-c399-b744f2155da0">LsaSetSystemAccessAccount Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="3790b97b-ec4c-405b-bc74-5c3538eac873.htm" title="MapGenericMask Method " tocid="3790b97b-ec4c-405b-bc74-5c3538eac873">MapGenericMask Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="4af3fd4d-ddc6-aade-fd19-14fd0bab5090.htm" title="OpenProcessToken Method " tocid="4af3fd4d-ddc6-aade-fd19-14fd0bab5090">OpenProcessToken Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="0c318ce2-dbe7-d0a4-9f9e-fa5dc2884ba7.htm" title="OpenThreadToken Method " tocid="0c318ce2-dbe7-d0a4-9f9e-fa5dc2884ba7">OpenThreadToken Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="02c1e781-edd4-9972-5c1c-3d3f026e72cd.htm" title="PrivilegeCheck Method " tocid="02c1e781-edd4-9972-5c1c-3d3f026e72cd">PrivilegeCheck Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="f0a83cab-68e6-62ae-4d81-dc771f62afae.htm" title="QueryServiceConfig Method " tocid="f0a83cab-68e6-62ae-4d81-dc771f62afae">QueryServiceConfig Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="205ce963-4931-d5af-cfa5-b87db2885d57.htm" title="QueryServiceConfig2 Method " tocid="205ce963-4931-d5af-cfa5-b87db2885d57">QueryServiceConfig2 Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="1985a69e-9290-678b-1f7a-fba6e737336e.htm" title="RegCloseKey Method " tocid="1985a69e-9290-678b-1f7a-fba6e737336e">RegCloseKey Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="4acd1687-3562-8670-4813-eb4f8a4e385f.htm" title="RegNotifyChangeKeyValue Method " tocid="4acd1687-3562-8670-4813-eb4f8a4e385f">RegNotifyChangeKeyValue Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9e370856-886e-048e-e8e3-f5888663b242.htm" title="RegOpenKeyEx Method " tocid="9e370856-886e-048e-e8e3-f5888663b242">RegOpenKeyEx Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="7d670bc2-2772-9a36-f0af-feab25c88aa3.htm" title="RevertToSelf Method " tocid="7d670bc2-2772-9a36-f0af-feab25c88aa3">RevertToSelf Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="4be05161-d8b0-fee1-9273-f2be95a3be81.htm" title="SetNamedSecurityInfo Method " tocid="4be05161-d8b0-fee1-9273-f2be95a3be81">SetNamedSecurityInfo Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d11a9d2c-59c6-2de5-e88a-8694cf796990.htm" title="SetThreadToken Method " tocid="d11a9d2c-59c6-2de5-e88a-8694cf796990">SetThreadToken Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>AdvApi32<span id="LSTBB758B45_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_0?cpp=::|nu=.");</script>LsaLookupNames2 Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            The LsaLookupNames2 function retrieves the security identifiers (SIDs) for specified account names. LsaLookupNames2 can look up the SID for any
            account in any domain in a Windows forest.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.Security (in Vanara.PInvoke.Security.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">uint</span> <span class="identifier">LsaLookupNames2</span>(
	<span class="identifier">AdvApi32<span id="LSTBB758B45_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLsaPolicyHandle</span> <span class="parameter">PolicyHandle</span>,
	<span class="identifier">AdvApi32<span id="LSTBB758B45_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>LsaLookupNamesFlags</span> <span class="parameter">Flags</span>,
	<span class="identifier">uint</span> <span class="parameter">Count</span>,
	<span class="identifier">string</span>[] <span class="parameter">Names</span>,
	<span class="keyword">out</span> <span class="identifier">AdvApi32<span id="LSTBB758B45_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLsaMemoryHandle</span> <span class="parameter">ReferencedDomains</span>,
	<span class="keyword">out</span> <span class="identifier">AdvApi32<span id="LSTBB758B45_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLsaMemoryHandle</span> <span class="parameter">Sids</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">LsaLookupNames2</span> ( 
	<span class="parameter">PolicyHandle</span> <span class="keyword">As</span> <span class="identifier">AdvApi32<span id="LSTBB758B45_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLsaPolicyHandle</span>,
	<span class="parameter">Flags</span> <span class="keyword">As</span> <span class="identifier">AdvApi32<span id="LSTBB758B45_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>LsaLookupNamesFlags</span>,
	<span class="parameter">Count</span> <span class="keyword">As</span> <span class="identifier">UInteger</span>,
	<span class="parameter">Names</span> <span class="keyword">As</span> <span class="identifier">String</span>(),
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">ReferencedDomains</span> <span class="keyword">As</span> <span class="identifier">AdvApi32<span id="LSTBB758B45_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLsaMemoryHandle</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">Sids</span> <span class="keyword">As</span> <span class="identifier">AdvApi32<span id="LSTBB758B45_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLsaMemoryHandle</span>
) <span class="keyword">As</span> <span class="identifier">UInteger</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">PolicyHandle</span></dt><dd>Type: <a href="50d1a7a0-bd75-68be-0efc-80f84cb83ca4.htm">Vanara.PInvoke<span id="LSTBB758B45_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AdvApi32<span id="LSTBB758B45_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLsaPolicyHandle</a><br />
            A handle to a Policy object. The handle must have the POLICY_LOOKUP_NAMES access right. For more information, see Opening a Policy Object Handle.
            </dd><dt><span class="parameter">Flags</span></dt><dd>Type: <a href="c72b1296-1b75-866a-c9dc-6d72adec8fa0.htm">Vanara.PInvoke<span id="LSTBB758B45_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AdvApi32<span id="LSTBB758B45_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>LsaLookupNamesFlags</a><br />Values that control the behavior of this function.</dd><dt><span class="parameter">Count</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">System<span id="LSTBB758B45_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt32</a><br />Specifies the number of names in the Names array. This is also the number of entries returned in the Sids array.</dd><dt><span class="parameter">Names</span></dt><dd>Type: <span id="LSTBB758B45_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_14?cpp=array&lt;");</script><a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTBB758B45_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_15?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><span id="LSTBB758B45_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_16?cpp=&gt;|vb=()|nu=[]");</script><br />
            An array of strings that contain the names to look up. These strings can be the names of user, group, or local group accounts, or the names of
            domains. Domain names can be DNS domain names or NetBIOS domain names.
            </dd><dt><span class="parameter">ReferencedDomains</span></dt><dd>Type: <a href="86269b7f-4e16-9d93-7836-4d963c121c67.htm">Vanara.PInvoke<span id="LSTBB758B45_17"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_17?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AdvApi32<span id="LSTBB758B45_18"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_18?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLsaMemoryHandle</a><span id="LSTBB758B45_19"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_19?cpp=%");</script><br />
            Receives a pointer to an LSA_REFERENCED_DOMAIN_LIST structure. The Domains member of this structure is an array that contains an entry for each
            domain in which a name was found. The DomainIndex member of each entry in the Sids array is the index of the Domains array entry for the domain in
            which the name was found.
            </dd><dt><span class="parameter">Sids</span></dt><dd>Type: <a href="86269b7f-4e16-9d93-7836-4d963c121c67.htm">Vanara.PInvoke<span id="LSTBB758B45_20"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_20?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>AdvApi32<span id="LSTBB758B45_21"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_21?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLsaMemoryHandle</a><span id="LSTBB758B45_22"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTBB758B45_22?cpp=%");</script><br />
            Receives a pointer to an array of LSA_TRANSLATED_SID2 structures. Each entry in the Sids array contains the SID information for the corresponding
            entry in the Names array.
            </dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">UInt32</a><br />
            If the function succeeds, the function returns one of the following NTSTATUS values. If the function fails, the return value is the following
            NTSTATUS value or one of the LSA Policy Function Return Values.
            </div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="9e2975d6-cd80-a5d1-8428-fefbd08eac87.htm">AdvApi32 Class</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>