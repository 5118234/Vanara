<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>WinINet.InternetConnect Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="InternetConnect method" /><meta name="System.Keywords" content="WinINet.InternetConnect method" /><meta name="Microsoft.Help.F1" content="Vanara.PInvoke.WinINet.InternetConnect" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.WinINet.InternetConnect(Vanara.PInvoke.WinINet.SafeInternetHandle,System.String,System.UInt16,System.String,System.String,Vanara.PInvoke.WinINet.InternetService,Vanara.PInvoke.WinINet.InternetApiFlags,System.IntPtr)" /><meta name="Description" content="Opens an File Transfer Protocol (FTP) or HTTP session for a given site." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="00bdfa4a-f9a5-be38-0acd-bf06f58b1e73" /><meta name="guid" content="00bdfa4a-f9a5-be38-0acd-bf06f58b1e73" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="6da97b10-d950-d7c3-3eea-424d686d0767.htm" title="WinINet Class" tocid="6da97b10-d950-d7c3-3eea-424d686d0767">WinINet Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="03d6dbf8-a60e-2ccc-4524-1040a6ac0dc2.htm" title="WinINet Methods" tocid="03d6dbf8-a60e-2ccc-4524-1040a6ac0dc2">WinINet Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="36d38116-8601-baac-0ed3-b09293fa7da8.htm" title="InternetCloseHandle Method " tocid="36d38116-8601-baac-0ed3-b09293fa7da8">InternetCloseHandle Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="00bdfa4a-f9a5-be38-0acd-bf06f58b1e73.htm" title="InternetConnect Method " tocid="00bdfa4a-f9a5-be38-0acd-bf06f58b1e73">InternetConnect Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="0c051368-d976-bc5a-7476-20914d63766c.htm" title="InternetOpen Method " tocid="0c051368-d976-bc5a-7476-20914d63766c">InternetOpen Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="38ae7ba1-961e-d9ab-649d-8d238a2b960f.htm" title="InternetQueryOption Method " tocid="38ae7ba1-961e-d9ab-649d-8d238a2b960f">InternetQueryOption Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="67d117ea-a97e-d07f-ade7-60c7d436a6da.htm" title="InternetSetOption Method " tocid="67d117ea-a97e-d07f-ade7-60c7d436a6da">InternetSetOption Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="ba2219da-f600-3ed0-f9fa-45b885c00e9a.htm" title="InternetSetStatusCallback Method " tocid="ba2219da-f600-3ed0-f9fa-45b885c00e9a">InternetSetStatusCallback Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>WinINet<span id="LSTF453360F_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_0?cpp=::|nu=.");</script>InternetConnect Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">Opens an File Transfer Protocol (FTP) or HTTP session for a given site.</div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.WinINet (in Vanara.PInvoke.WinINet.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">WinINet<span id="LSTF453360F_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeInternetConnectHandle</span> <span class="identifier">InternetConnect</span>(
	<span class="identifier">WinINet<span id="LSTF453360F_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeInternetHandle</span> <span class="parameter">hInternet</span>,
	<span class="identifier">string</span> <span class="parameter">lpszServerName</span>,
	<span class="identifier">ushort</span> <span class="parameter">nServerPort</span>,
	<span class="identifier">string</span> <span class="parameter">lpszUsername</span>,
	<span class="identifier">string</span> <span class="parameter">lpszPassword</span>,
	<span class="identifier">WinINet<span id="LSTF453360F_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>InternetService</span> <span class="parameter">dwService</span>,
	<span class="identifier">WinINet<span id="LSTF453360F_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>InternetApiFlags</span> <span class="parameter">dwFlags</span>,
	<span class="identifier">IntPtr</span> <span class="parameter">dwContext</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">InternetConnect</span> ( 
	<span class="parameter">hInternet</span> <span class="keyword">As</span> <span class="identifier">WinINet<span id="LSTF453360F_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeInternetHandle</span>,
	<span class="parameter">lpszServerName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">nServerPort</span> <span class="keyword">As</span> <span class="identifier">UShort</span>,
	<span class="parameter">lpszUsername</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">lpszPassword</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">dwService</span> <span class="keyword">As</span> <span class="identifier">WinINet<span id="LSTF453360F_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>InternetService</span>,
	<span class="parameter">dwFlags</span> <span class="keyword">As</span> <span class="identifier">WinINet<span id="LSTF453360F_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>InternetApiFlags</span>,
	<span class="parameter">dwContext</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>
) <span class="keyword">As</span> <span class="identifier">WinINet<span id="LSTF453360F_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeInternetConnectHandle</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">hInternet</span></dt><dd>Type: <a href="a37acc5e-e5bd-f27c-d56f-6f6016ff49d6.htm">Vanara.PInvoke<span id="LSTF453360F_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>WinINet<span id="LSTF453360F_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeInternetHandle</a><br />Handle returned by a previous call to InternetOpen.</dd><dt><span class="parameter">lpszServerName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTF453360F_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
            A string that specifies the host name of an Internet server. Alternately, the string can contain the IP number of the site, in ASCII dotted-decimal
            format (for example, 11.0.1.45).
            </dd><dt><span class="parameter">nServerPort</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s6eyk10z" target="_blank">System<span id="LSTF453360F_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt16</a><br />
            Transmission Control Protocol/Internet Protocol (TCP/IP) port on the server. These flags set only the port that is used. The service is set by the
            value of dwService.
            </dd><dt><span class="parameter">lpszUsername</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTF453360F_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
            A string that specifies the name of the user to log on. If this parameter is NULL, the function uses an appropriate default. For the FTP protocol,
            the default is "anonymous".
            </dd><dt><span class="parameter">lpszPassword</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LSTF453360F_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_14?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
            A string that contains the password to use to log on. If both lpszPassword and lpszUsername are NULL, the function uses the default "anonymous"
            password. In the case of FTP, the default password is the user's email name. If lpszPassword is NULL, but lpszUsername is not NULL, the function uses
            a blank password.
            </dd><dt><span class="parameter">dwService</span></dt><dd>Type: <a href="8103b398-a16a-7037-dddf-5fe68bef0580.htm">Vanara.PInvoke<span id="LSTF453360F_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_15?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>WinINet<span id="LSTF453360F_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_16?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>InternetService</a><br />Type of service to access.</dd><dt><span class="parameter">dwFlags</span></dt><dd>Type: <a href="4a054a06-5edf-89a2-498d-0cec49f6f802.htm">Vanara.PInvoke<span id="LSTF453360F_17"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_17?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>WinINet<span id="LSTF453360F_18"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_18?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>InternetApiFlags</a><br />
            Options specific to the service used. If dwService is INTERNET_SERVICE_FTP, INTERNET_FLAG_PASSIVE causes the application to use passive FTP semantics.
            </dd><dt><span class="parameter">dwContext</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LSTF453360F_19"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_19?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><br />
            Pointer to a variable that contains an application-defined value that is used to identify the application context for the returned handle in callbacks.
            </dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="715df59b-7ee6-02f8-fc77-851da9394245.htm">WinINet<span id="LSTF453360F_20"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF453360F_20?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeInternetConnectHandle</a><br />
            Returns a valid handle to the session if the connection is successful, or NULL otherwise. To retrieve extended error information, call GetLastError.
            An application can also use InternetGetLastResponseInfo to determine why access to the service was denied.
            </div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="6da97b10-d950-d7c3-3eea-424d686d0767.htm">WinINet Class</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>