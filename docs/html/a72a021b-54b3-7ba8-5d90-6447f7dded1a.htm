<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>User32.LoadString Method (Kernel32.SafeLibraryHandle, Int32, IntPtr, Int32)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.User32.LoadString(Vanara.PInvoke.Kernel32.SafeLibraryHandle,System.Int32,System.IntPtr@,System.Int32)" /><meta name="Description" content="Loads a string resource from the executable file associated with a specified module, copies the string into a buffer, and appends a terminating null character." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="a72a021b-54b3-7ba8-5d90-6447f7dded1a" /><meta name="guid" content="a72a021b-54b3-7ba8-5d90-6447f7dded1a" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="3103c69b-f461-3a6f-fa1d-60fd26adf4f9.htm" title="User32 Class" tocid="3103c69b-f461-3a6f-fa1d-60fd26adf4f9">User32 Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="bf125316-820d-e4b3-dc45-ce0e2ab66b64.htm" title="User32 Methods" tocid="bf125316-820d-e4b3-dc45-ce0e2ab66b64">User32 Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="51c86a69-a515-efb3-bdbe-6a492bbb3cca.htm" title="LoadString Method " tocid="51c86a69-a515-efb3-bdbe-6a492bbb3cca">LoadString Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="a72a021b-54b3-7ba8-5d90-6447f7dded1a.htm" title="LoadString Method (Kernel32.SafeLibraryHandle, Int32, IntPtr, Int32)" tocid="a72a021b-54b3-7ba8-5d90-6447f7dded1a">LoadString Method (Kernel32.SafeLibraryHandle, Int32, IntPtr, Int32)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="94789a43-ddf7-de1b-d7ec-4344372fed70.htm" title="LoadString Method (Kernel32.SafeLibraryHandle, Int32, StringBuilder, Int32)" tocid="94789a43-ddf7-de1b-d7ec-4344372fed70">LoadString Method (Kernel32.SafeLibraryHandle, Int32, StringBuilder, Int32)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>User32<span id="LST80CED570_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80CED570_0?cpp=::|nu=.");</script>LoadString Method (Kernel32<span id="LST80CED570_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80CED570_1?cpp=::|nu=.");</script>SafeLibraryHandle, Int32, IntPtr<span id="LST80CED570_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80CED570_2?cpp=%");</script>, Int32)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Loads a string resource from the executable file associated with a specified module, copies the string into a buffer, and appends a terminating null character.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.User32 (in Vanara.PInvoke.User32.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">int</span> <span class="identifier">LoadString</span>(
	<span class="identifier">Kernel32<span id="LST80CED570_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80CED570_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLibraryHandle</span> <span class="parameter">hInstance</span>,
	<span class="identifier">int</span> <span class="parameter">uID</span>,
	<span class="keyword">out</span> <span class="identifier">IntPtr</span> <span class="parameter">lpBuffer</span>,
	<span class="identifier">int</span> <span class="parameter">nBufferMax</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">LoadString</span> ( 
	<span class="parameter">hInstance</span> <span class="keyword">As</span> <span class="identifier">Kernel32<span id="LST80CED570_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80CED570_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLibraryHandle</span>,
	<span class="parameter">uID</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">lpBuffer</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">nBufferMax</span> <span class="keyword">As</span> <span class="identifier">Integer</span>
) <span class="keyword">As</span> <span class="identifier">Integer</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">hInstance</span></dt><dd>Type: <a href="81c22d72-0859-8cc2-6acb-28daf30b232e.htm">Vanara.PInvoke<span id="LST80CED570_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80CED570_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Kernel32<span id="LST80CED570_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80CED570_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeLibraryHandle</a><br />A handle to an instance of the module whose executable file contains the string resource. To get the handle to the application itself, call the GetModuleHandle function with NULL.</dd><dt><span class="parameter">uID</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST80CED570_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80CED570_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />The identifier of the string to be loaded.</dd><dt><span class="parameter">lpBuffer</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LST80CED570_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80CED570_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><span id="LST80CED570_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80CED570_9?cpp=%");</script><br />The buffer is to receive the string. Must be of sufficient length to hold a pointer (8 bytes).</dd><dt><span class="parameter">nBufferMax</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST80CED570_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST80CED570_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />The size of the buffer, in characters. The string is truncated and null-terminated if it is longer than the number of characters specified. If this parameter is 0, then lpBuffer receives a read-only pointer to the resource itself.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Int32</a><br />If the function succeeds, the return value is the number of characters copied into the buffer, not including the terminating null character, or zero if the string resource does not exist. To get extended error information, call GetLastError.</div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="3103c69b-f461-3a6f-fa1d-60fd26adf4f9.htm">User32 Class</a></div><div class="seeAlsoStyle"><a href="51c86a69-a515-efb3-bdbe-6a492bbb3cca.htm">LoadString Overload</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>