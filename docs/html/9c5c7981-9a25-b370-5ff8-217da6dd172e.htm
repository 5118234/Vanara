<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Ole32.StgOpenStorage Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="StgOpenStorage method" /><meta name="System.Keywords" content="Ole32.StgOpenStorage method" /><meta name="Microsoft.Help.F1" content="Vanara.PInvoke.Ole32.StgOpenStorage" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.Ole32.StgOpenStorage(System.String,Vanara.PInvoke.Ole32.IStorage,Vanara.PInvoke.STGM,Vanara.PInvoke.Ole32.SNB,System.UInt32,Vanara.PInvoke.Ole32.IStorage@)" /><meta name="Description" content="The StgOpenStorage function opens an existing root storage object in the file system. Use this function to open compound files. Do not use it to open directories, files, or summary catalogs." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="9c5c7981-9a25-b370-5ff8-217da6dd172e" /><meta name="guid" content="9c5c7981-9a25-b370-5ff8-217da6dd172e" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="34191c95-a05e-a3a2-0f94-c72e121807f5.htm" title="Ole32 Class" tocid="34191c95-a05e-a3a2-0f94-c72e121807f5">Ole32 Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c35bbc54-4863-ba25-6689-a59b4f48268d.htm" title="Ole32 Methods" tocid="c35bbc54-4863-ba25-6689-a59b4f48268d">Ole32 Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d2ddcd7f-2ce5-2da2-3ebe-1a1eb5e4dbc1.htm" title="CoInitializeEx Method " tocid="d2ddcd7f-2ce5-2da2-3ebe-1a1eb5e4dbc1">CoInitializeEx Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9a875657-14bc-e447-a210-5038dd11a029.htm" title="CoUninitialize Method " tocid="9a875657-14bc-e447-a210-5038dd11a029">CoUninitialize Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="10fb1f1e-7530-d083-2173-4901fdaf145d.htm" title="OleInitialize Method " tocid="10fb1f1e-7530-d083-2173-4901fdaf145d">OleInitialize Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="9608851b-8a96-8706-4907-957c96e91a95.htm" title="OleUninitialize Method " tocid="9608851b-8a96-8706-4907-957c96e91a95">OleUninitialize Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="a2915927-ebc8-1b9d-0f65-02a19e69d7da.htm" title="PropVariantClear Method " tocid="a2915927-ebc8-1b9d-0f65-02a19e69d7da">PropVariantClear Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="dc166849-fc03-17d9-b220-6ee8bc9bf7a9.htm" title="PropVariantCopy Method " tocid="dc166849-fc03-17d9-b220-6ee8bc9bf7a9">PropVariantCopy Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="8e001a9b-c404-7519-623f-f24913d92bf1.htm" title="ReleaseStgMedium Method " tocid="8e001a9b-c404-7519-623f-f24913d92bf1">ReleaseStgMedium Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="015649d5-b3cc-519f-9b42-c971c5c6ba20.htm" title="StgCreateStorageEx Method " tocid="015649d5-b3cc-519f-9b42-c971c5c6ba20">StgCreateStorageEx Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="27d0717e-d8ab-362b-70f6-42fc293a2835.htm" title="StgIsStorageFile Method " tocid="27d0717e-d8ab-362b-70f6-42fc293a2835">StgIsStorageFile Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="9c5c7981-9a25-b370-5ff8-217da6dd172e.htm" title="StgOpenStorage Method " tocid="9c5c7981-9a25-b370-5ff8-217da6dd172e">StgOpenStorage Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="f449634d-cd1a-db9d-2297-5ef962cdf2a7.htm" title="StgOpenStorageEx Method " tocid="f449634d-cd1a-db9d-2297-5ef962cdf2a7">StgOpenStorageEx Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Ole32<span id="LST8AFD77B4_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_0?cpp=::|nu=.");</script>StgOpenStorage Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">The StgOpenStorage function opens an existing root storage object in the file system. Use this function to open compound files. Do not use it to open directories, files, or summary catalogs. Nested storage objects can only be opened using their parent IStorage::OpenStorage method.
            <div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td>Applications should use the new function, StgOpenStorageEx, instead of StgOpenStorage, to take advantage of the enhanced and Windows Structured Storage features. This function, StgOpenStorage, still exists for compatibility with applications running on Windows 2000.</td></tr></table></div></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.Ole (in Vanara.PInvoke.Ole.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">HRESULT</span> <span class="identifier">StgOpenStorage</span>(
	<span class="identifier">string</span> <span class="parameter">pwcsName</span>,
	<span class="identifier">Ole32<span id="LST8AFD77B4_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IStorage</span> <span class="parameter">pstgPriority</span>,
	<span class="identifier">STGM</span> <span class="parameter">grfMode</span>,
	<span class="identifier">Ole32<span id="LST8AFD77B4_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SNB</span> <span class="parameter">snbExclude</span>,
	<span class="identifier">uint</span> <span class="parameter">reserved</span>,
	<span class="keyword">out</span> <span class="identifier">Ole32<span id="LST8AFD77B4_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IStorage</span> <span class="parameter">ppstgOpen</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">StgOpenStorage</span> ( 
	<span class="parameter">pwcsName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">pstgPriority</span> <span class="keyword">As</span> <span class="identifier">Ole32<span id="LST8AFD77B4_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IStorage</span>,
	<span class="parameter">grfMode</span> <span class="keyword">As</span> <span class="identifier">STGM</span>,
	<span class="parameter">snbExclude</span> <span class="keyword">As</span> <span class="identifier">Ole32<span id="LST8AFD77B4_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SNB</span>,
	<span class="parameter">reserved</span> <span class="keyword">As</span> <span class="identifier">UInteger</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">ppstgOpen</span> <span class="keyword">As</span> <span class="identifier">Ole32<span id="LST8AFD77B4_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IStorage</span>
) <span class="keyword">As</span> <span class="identifier">HRESULT</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">pwcsName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST8AFD77B4_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />A pointer to the path of the null-terminated Unicode string file that contains the storage object to open. This parameter is ignored if the pstgPriority parameter is not NULL.</dd><dt><span class="parameter">pstgPriority</span></dt><dd>Type: <a href="2cb36baf-6cfe-3a94-97ba-efaac5a5927d.htm">Vanara.PInvoke<span id="LST8AFD77B4_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Ole32<span id="LST8AFD77B4_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IStorage</a><br />A pointer to the IStorage interface that should be NULL. If not NULL, this parameter is used as described below in the Remarks section. After StgOpenStorage returns, the storage object specified in pStgPriority may have been released and should no longer be used.</dd><dt><span class="parameter">grfMode</span></dt><dd>Type: <a href="ed3a09b2-f303-472a-af02-2c98bfbb263b.htm">Vanara.PInvoke<span id="LST8AFD77B4_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>STGM</a><br />Specifies the access mode to use to open the storage object.</dd><dt><span class="parameter">snbExclude</span></dt><dd>Type: <a href="d8b0fabc-dede-dffb-a277-9a566446670a.htm">Vanara.PInvoke<span id="LST8AFD77B4_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Ole32<span id="LST8AFD77B4_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SNB</a><br />If not NULL, pointer to a block of elements in the storage to be excluded as the storage object is opened. The exclusion occurs regardless of whether a snapshot copy happens on the open. Can be NULL.</dd><dt><span class="parameter">reserved</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">System<span id="LST8AFD77B4_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt32</a><br />Indicates reserved for future use; must be zero.</dd><dt><span class="parameter">ppstgOpen</span></dt><dd>Type: <a href="2cb36baf-6cfe-3a94-97ba-efaac5a5927d.htm">Vanara.PInvoke<span id="LST8AFD77B4_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_14?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Ole32<span id="LST8AFD77B4_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_15?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IStorage</a><span id="LST8AFD77B4_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST8AFD77B4_16?cpp=%");</script><br />A pointer to a IStorage* pointer variable that receives the interface pointer to the opened storage.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="b6fb8f7d-a892-011d-4d7f-4b60a53a0104.htm">HRESULT</a><br />The StgOpenStorage function can also return any file system errors or system errors wrapped in an HRESULT. For more information, see Error Handling Strategies and Handling Unknown Errors.</div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="34191c95-a05e-a3a2-0f94-c72e121807f5.htm">Ole32 Class</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>