<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Kernel32.FormatMessage Method (Kernel32.FormatMessageFlags, IntPtr, UInt32, UInt32, IntPtr, UInt32, String[])</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.Kernel32.FormatMessage(Vanara.PInvoke.Kernel32.FormatMessageFlags,System.IntPtr,System.UInt32,System.UInt32,System.IntPtr@,System.UInt32,System.String[])" /><meta name="Description" content="Formats a message string. The function requires a message definition as input. The message definition can come from a buffer passed into the function. It can come from a message table resource in an already-loaded module." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="e56c4fce-b05b-f147-f870-7d3890beba64" /><meta name="guid" content="e56c4fce-b05b-f147-f870-7d3890beba64" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="44c5555c-a81e-30f0-1ed7-2f42856e9dd3.htm" title="Kernel32 Class" tocid="44c5555c-a81e-30f0-1ed7-2f42856e9dd3">Kernel32 Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="e0c356d3-afb6-0755-9784-8a8838aa400f.htm" title="Kernel32 Methods" tocid="e0c356d3-afb6-0755-9784-8a8838aa400f">Kernel32 Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="fd6049c5-287e-ff89-3cd2-ed76a5ec56f1.htm" title="FormatMessage Method " tocid="fd6049c5-287e-ff89-3cd2-ed76a5ec56f1">FormatMessage Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="a01b0c0f-263e-9f50-2cca-a9247eb0ac2b.htm" title="FormatMessage Method (String, String[], Kernel32.FormatMessageFlags)" tocid="a01b0c0f-263e-9f50-2cca-a9247eb0ac2b">FormatMessage Method (String, String[], Kernel32.FormatMessageFlags)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="8bf41e52-6457-3e21-107a-4b4f784e3f21.htm" title="FormatMessage Method (UInt32, String[], Kernel32.SafeLibraryHandle, Kernel32.FormatMessageFlags, UInt32)" tocid="8bf41e52-6457-3e21-107a-4b4f784e3f21">FormatMessage Method (UInt32, String[], Kernel32.SafeLibraryHandle, Kernel32.FormatMessageFlags, UInt32)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="e56c4fce-b05b-f147-f870-7d3890beba64.htm" title="FormatMessage Method (Kernel32.FormatMessageFlags, IntPtr, UInt32, UInt32, IntPtr, UInt32, String[])" tocid="e56c4fce-b05b-f147-f870-7d3890beba64">FormatMessage Method (Kernel32.FormatMessageFlags, IntPtr, UInt32, UInt32, IntPtr, UInt32, String[])</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="e3feda05-1262-4f21-23a0-aaf733404304.htm" title="FormatMessage Method (Kernel32.FormatMessageFlags, Kernel32.SafeLibraryHandle, UInt32, UInt32, IntPtr, UInt32, String[])" tocid="e3feda05-1262-4f21-23a0-aaf733404304">FormatMessage Method (Kernel32.FormatMessageFlags, Kernel32.SafeLibraryHandle, UInt32, UInt32, IntPtr, UInt32, String[])</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Kernel32<span id="LST5D7805AB_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_0?cpp=::|nu=.");</script>FormatMessage Method (Kernel32<span id="LST5D7805AB_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_1?cpp=::|nu=.");</script>FormatMessageFlags, IntPtr, UInt32, UInt32, IntPtr<span id="LST5D7805AB_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_2?cpp=%");</script>, UInt32, <span id="LST5D7805AB_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_3?cpp=array&lt;");</script>String<span id="LST5D7805AB_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_4?cpp=&gt;|vb=()|nu=[]");</script>)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Formats a message string. The function requires a message definition as input. The message definition can come from a buffer passed into the
            function. It can come from a message table resource in an already-loaded module. Or the caller can ask the function to search the system's message
            table resource(s) for the message definition. The function finds the message definition in a message table resource based on a message identifier and
            a language identifier. The function copies the formatted message text to an output buffer, processing any embedded insert sequences if requested.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.Kernel32 (in Vanara.PInvoke.Kernel32.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">int</span> <span class="identifier">FormatMessage</span>(
	<span class="identifier">Kernel32<span id="LST5D7805AB_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FormatMessageFlags</span> <span class="parameter">dwFlags</span>,
	<span class="identifier">IntPtr</span> <span class="parameter">lpSource</span>,
	<span class="identifier">uint</span> <span class="parameter">dwMessageId</span>,
	<span class="identifier">uint</span> <span class="parameter">dwLanguageId</span>,
	<span class="keyword">ref</span> <span class="identifier">IntPtr</span> <span class="parameter">lpBuffer</span>,
	<span class="identifier">uint</span> <span class="parameter">nSize</span>,
	<span class="identifier">string</span>[] <span class="parameter">arguments</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">FormatMessage</span> ( 
	<span class="parameter">dwFlags</span> <span class="keyword">As</span> <span class="identifier">Kernel32<span id="LST5D7805AB_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FormatMessageFlags</span>,
	<span class="parameter">lpSource</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">dwMessageId</span> <span class="keyword">As</span> <span class="identifier">UInteger</span>,
	<span class="parameter">dwLanguageId</span> <span class="keyword">As</span> <span class="identifier">UInteger</span>,
	<span class="keyword">ByRef</span> <span class="parameter">lpBuffer</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">nSize</span> <span class="keyword">As</span> <span class="identifier">UInteger</span>,
	<span class="parameter">arguments</span> <span class="keyword">As</span> <span class="identifier">String</span>()
) <span class="keyword">As</span> <span class="identifier">Integer</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">dwFlags</span></dt><dd>Type: <a href="9a87a785-6857-551a-2749-8d47ff4212a0.htm">Vanara.PInvoke<span id="LST5D7805AB_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Kernel32<span id="LST5D7805AB_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FormatMessageFlags</a><br />
            The formatting options, and how to interpret the lpSource parameter. The low-order byte of dwFlags specifies how the function handles line breaks in
            the output buffer. The low-order byte can also specify the maximum width of a formatted output line.
            </dd><dt><span class="parameter">lpSource</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LST5D7805AB_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><br />
            The location of the message definition. The type of this parameter depends upon the settings in the <span class="parameter">dwFlags</span> parameter. If
            <a href="9a87a785-6857-551a-2749-8d47ff4212a0.htm">FORMAT_MESSAGE_FROM_HMODULE</a>: A handle to the module that contains the message table to search. If
            <a href="9a87a785-6857-551a-2749-8d47ff4212a0.htm">FORMAT_MESSAGE_FROM_STRING</a>: Pointer to a string that consists of unformatted message text. It will be scanned for
            inserts and formatted accordingly. If neither of these flags is set in dwFlags, then lpSource is ignored.
            </dd><dt><span class="parameter">dwMessageId</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">System<span id="LST5D7805AB_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt32</a><br />The message identifier for the requested message. This parameter is ignored if dwFlags includes <a href="9a87a785-6857-551a-2749-8d47ff4212a0.htm">FORMAT_MESSAGE_FROM_STRING</a>.</dd><dt><span class="parameter">dwLanguageId</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">System<span id="LST5D7805AB_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt32</a><br />
            The language identifier for the requested message. This parameter is ignored if dwFlags includes
            <a href="9a87a785-6857-551a-2749-8d47ff4212a0.htm">FORMAT_MESSAGE_FROM_STRING</a>. If you pass a specific LANGID in this parameter, FormatMessage will return a message for
            that LANGID only. If the function cannot find a message for that LANGID, it sets Last-Error to ERROR_RESOURCE_LANG_NOT_FOUND. If you pass in zero,
            FormatMessage looks for a message for LANGIDs in the following order: Language neutral Thread LANGID, based on the thread's locale value User default
            LANGID, based on the user's default locale value System default LANGID, based on the system default locale value US English If FormatMessage does not
            locate a message for any of the preceding LANGIDs, it returns any language message string that is present. If that fails, it returns ERROR_RESOURCE_LANG_NOT_FOUND.
            </dd><dt><span class="parameter">lpBuffer</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LST5D7805AB_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><span id="LST5D7805AB_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_13?cpp=%");</script><br />
            A pointer to a buffer that receives the null-terminated string that specifies the formatted message. If dwFlags includes
            <a href="9a87a785-6857-551a-2749-8d47ff4212a0.htm">FORMAT_MESSAGE_ALLOCATE_BUFFER</a>, the function allocates a buffer using the LocalAlloc function, and places the
            pointer to the buffer at the address specified in lpBuffer. This buffer cannot be larger than 64K bytes.
            </dd><dt><span class="parameter">nSize</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">System<span id="LST5D7805AB_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_14?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt32</a><br />
            If the <a href="9a87a785-6857-551a-2749-8d47ff4212a0.htm">FORMAT_MESSAGE_ALLOCATE_BUFFER</a> flag is not set, this parameter specifies the size of the output buffer, in
            TCHARs. If <a href="9a87a785-6857-551a-2749-8d47ff4212a0.htm">FORMAT_MESSAGE_ALLOCATE_BUFFER</a> is set, this parameter specifies the minimum number of TCHARs to allocate
            for an output buffer. The output buffer cannot be larger than 64K bytes.
            </dd><dt><span class="parameter">arguments</span></dt><dd>Type: <span id="LST5D7805AB_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_15?cpp=array&lt;");</script><a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST5D7805AB_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_16?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><span id="LST5D7805AB_17"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST5D7805AB_17?cpp=&gt;|vb=()|nu=[]");</script><br />
            An array of values that are used as insert values in the formatted message. A %1 in the format string indicates the first value in the Arguments
            array; a %2 indicates the second argument; and so on. The interpretation of each value depends on the formatting information associated with the
            insert in the message definition.The default is to treat each value as a pointer to a null-terminated string. By default, the Arguments parameter is
            of type va_list*, which is a language- and implementation-specific data type for describing a variable number of arguments.The state of the va_list
            argument is undefined upon return from the function.To use the va_list again, destroy the variable argument list pointer using va_end and
            reinitialize it with va_start. If you do not have a pointer of type va_list*, then specify the FORMAT_MESSAGE_ARGUMENT_ARRAY flag and pass a pointer
            to an array of DWORD_PTR values; those values are input to the message formatted as the insert values.Each insert must have a corresponding element
            in the array.
            </dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Int32</a><br />
            If the function succeeds, the return value is the number of TCHARs stored in the output buffer, excluding the terminating null character. If the
            function fails, the return value is zero. To get extended error information, call GetLastError.
            </div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="44c5555c-a81e-30f0-1ed7-2f42856e9dd3.htm">Kernel32 Class</a></div><div class="seeAlsoStyle"><a href="fd6049c5-287e-ff89-3cd2-ed76a5ec56f1.htm">FormatMessage Overload</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>