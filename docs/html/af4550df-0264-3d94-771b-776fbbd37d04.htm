<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Kernel32.CreateFile Method (String, Kernel32.FileAccess, FileShare, SECURITY_ATTRIBUTES, FileMode, FileFlagsAndAttributes, SafeFileHandle)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.Kernel32.CreateFile(System.String,Vanara.PInvoke.Kernel32.FileAccess,System.IO.FileShare,Vanara.PInvoke.SECURITY_ATTRIBUTES,System.IO.FileMode,Vanara.PInvoke.FileFlagsAndAttributes,Microsoft.Win32.SafeHandles.SafeFileHandle)" /><meta name="Description" content="Creates or opens a file or I/O device. The most commonly used I/O devices are as follows: file, file stream, directory, physical disk, volume, console buffer, tape drive, communications resource, mailslot, and pipe." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="af4550df-0264-3d94-771b-776fbbd37d04" /><meta name="guid" content="af4550df-0264-3d94-771b-776fbbd37d04" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="44c5555c-a81e-30f0-1ed7-2f42856e9dd3.htm" title="Kernel32 Class" tocid="44c5555c-a81e-30f0-1ed7-2f42856e9dd3">Kernel32 Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="e0c356d3-afb6-0755-9784-8a8838aa400f.htm" title="Kernel32 Methods" tocid="e0c356d3-afb6-0755-9784-8a8838aa400f">Kernel32 Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="3812ec5f-2e54-3c57-6aa2-b483db2f48fb.htm" title="CreateFile Method " tocid="3812ec5f-2e54-3c57-6aa2-b483db2f48fb">CreateFile Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="af4550df-0264-3d94-771b-776fbbd37d04.htm" title="CreateFile Method (String, Kernel32.FileAccess, FileShare, SECURITY_ATTRIBUTES, FileMode, FileFlagsAndAttributes, SafeFileHandle)" tocid="af4550df-0264-3d94-771b-776fbbd37d04">CreateFile Method (String, Kernel32.FileAccess, FileShare, SECURITY_ATTRIBUTES, FileMode, FileFlagsAndAttributes, SafeFileHandle)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="2de4e4da-6fef-2ee3-2231-9caf9b588d42.htm" title="CreateFile Method (String, Kernel32.FileAccess, FileShare, SECURITY_ATTRIBUTES, FileMode, FileFlagsAndAttributes, IntPtr)" tocid="2de4e4da-6fef-2ee3-2231-9caf9b588d42">CreateFile Method (String, Kernel32.FileAccess, FileShare, SECURITY_ATTRIBUTES, FileMode, FileFlagsAndAttributes, IntPtr)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Kernel32<span id="LST88955B84_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_0?cpp=::|nu=.");</script>CreateFile Method (String, Kernel32<span id="LST88955B84_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_1?cpp=::|nu=.");</script>FileAccess, FileShare, SECURITY_ATTRIBUTES, FileMode, FileFlagsAndAttributes, SafeFileHandle)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Creates or opens a file or I/O device. The most commonly used I/O devices are as follows: file, file stream, directory, physical disk, volume,
            console buffer, tape drive, communications resource, mailslot, and pipe. The function returns a handle that can be used to access the file or device
            for various types of I/O depending on the file or device and the flags and attributes specified.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.Kernel32 (in Vanara.PInvoke.Kernel32.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">SafeFileHandle</span> <span class="identifier">CreateFile</span>(
	<span class="identifier">string</span> <span class="parameter">lpFileName</span>,
	<span class="identifier">Kernel32<span id="LST88955B84_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FileAccess</span> <span class="parameter">dwDesiredAccess</span>,
	<span class="identifier">FileShare</span> <span class="parameter">dwShareMode</span>,
	[<span class="identifier">OptionalAttribute</span>] <span class="identifier">SECURITY_ATTRIBUTES</span> <span class="parameter">lpSecurityAttributes</span>,
	<span class="identifier">FileMode</span> <span class="parameter">dwCreationDisposition</span>,
	<span class="identifier">FileFlagsAndAttributes</span> <span class="parameter">dwFlagsAndAttributes</span>,
	<span class="identifier">SafeFileHandle</span> <span class="parameter">hTemplateFile</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">CreateFile</span> ( 
	<span class="parameter">lpFileName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">dwDesiredAccess</span> <span class="keyword">As</span> <span class="identifier">Kernel32<span id="LST88955B84_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FileAccess</span>,
	<span class="parameter">dwShareMode</span> <span class="keyword">As</span> <span class="identifier">FileShare</span>,
	&lt;<span class="identifier">OptionalAttribute</span>&gt; <span class="parameter">lpSecurityAttributes</span> <span class="keyword">As</span> <span class="identifier">SECURITY_ATTRIBUTES</span>,
	<span class="parameter">dwCreationDisposition</span> <span class="keyword">As</span> <span class="identifier">FileMode</span>,
	<span class="parameter">dwFlagsAndAttributes</span> <span class="keyword">As</span> <span class="identifier">FileFlagsAndAttributes</span>,
	<span class="parameter">hTemplateFile</span> <span class="keyword">As</span> <span class="identifier">SafeFileHandle</span>
) <span class="keyword">As</span> <span class="identifier">SafeFileHandle</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">lpFileName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST88955B84_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />
            The name of the file or device to be created or opened. You may use either forward slashes (/) or backslashes (\) in this name.
            <p>
            In the ANSI version of this function, the name is limited to MAX_PATH characters. To extend this limit to 32,767 wide characters, call the Unicode
            version of the function and prepend "\\?\" to the path. For more information, see Naming Files, Paths, and Namespaces.
            </p><p>For information on special device names, see Defining an MS-DOS Device Name.</p><p>To create a file stream, specify the name of the file, a colon, and then the name of the stream. For more information, see File Streams.</p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Tip" /> Tip</th></tr><tr><td>Starting with Windows 10, version 1607, for the Unicode version of this function (CreateFileW), you can opt-in to remove the
            MAX_PATH limitation without prepending "\\?\". See the "Maximum Path Length Limitation" section of Naming Files, Paths, and Namespaces for details.</td></tr></table></div></dd><dt><span class="parameter">dwDesiredAccess</span></dt><dd>Type: <a href="31b386f3-e148-7a4b-766a-b86c7fc2ee4e.htm">Vanara.PInvoke<span id="LST88955B84_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Kernel32<span id="LST88955B84_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FileAccess</a><br />
            The requested access to the file or device, which can be summarized as read, write, both or neither zero).
            <p>
            The most commonly used values are GENERIC_READ, GENERIC_WRITE, or both (GENERIC_READ | GENERIC_WRITE). For more information, see Generic Access
            Rights, File Security and Access Rights, File Access Rights Constants, and ACCESS_MASK.
            </p><p>
            If this parameter is zero, the application can query certain metadata such as file, directory, or device attributes without accessing that file or
            device, even if GENERIC_READ access would have been denied.
            </p><p>
            You cannot request an access mode that conflicts with the sharing mode that is specified by the dwShareMode parameter in an open request that already
            has an open handle.
            </p></dd><dt><span class="parameter">dwShareMode</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/1f1h9xds" target="_blank">System.IO<span id="LST88955B84_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FileShare</a><br />
            The requested sharing mode of the file or device, which can be read, write, both, delete, all of these, or none (refer to the following table).
            Access requests to attributes or extended attributes are not affected by this flag.
            <p>
            If this parameter is zero and CreateFile succeeds, the file or device cannot be shared and cannot be opened again until the handle to the file or
            device is closed. For more information, see the Remarks section.
            </p><p>
            You cannot request a sharing mode that conflicts with the access mode that is specified in an existing request that has an open handle. CreateFile
            would fail and the GetLastError function would return ERROR_SHARING_VIOLATION.
            </p><p>
            To enable a process to share a file or device while another process has the file or device open, use a compatible combination of one or more of the
            following values. For more information about valid combinations of this parameter with the dwDesiredAccess parameter, see Creating and Opening Files.
            </p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td>The sharing options for each open handle remain in effect until that handle is closed, regardless of process context.</td></tr></table></div></dd><dt><span class="parameter">lpSecurityAttributes</span> (Optional)</dt><dd>Type: <a href="251c8684-e19e-8ec6-40a6-ead493f9cc76.htm">Vanara.PInvoke<span id="LST88955B84_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SECURITY_ATTRIBUTES</a><br />
            A pointer to a SECURITY_ATTRIBUTES structure that contains two separate but related data members: an optional security descriptor, and a Boolean
            value that determines whether the returned handle can be inherited by child processes.
            <p>This parameter can be NULL.</p><p>
            If this parameter is NULL, the handle returned by CreateFile cannot be inherited by any child processes the application may create and the file or
            device associated with the returned handle gets a default security descriptor.
            </p><p>
            The lpSecurityDescriptor member of the structure specifies a SECURITY_DESCRIPTOR for a file or device. If this member is NULL, the file or device
            associated with the returned handle is assigned a default security descriptor.
            </p><p>CreateFile ignores the lpSecurityDescriptor member when opening an existing file or device, but continues to use the bInheritHandle member.</p><p>The bInheritHandlemember of the structure specifies whether the returned handle can be inherited.</p></dd><dt><span class="parameter">dwCreationDisposition</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/6b40c5ay" target="_blank">System.IO<span id="LST88955B84_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FileMode</a><br />
            An action to take on a file or device that exists or does not exist.
            <p>For devices other than files, this parameter is usually set to OPEN_EXISTING.</p></dd><dt><span class="parameter">dwFlagsAndAttributes</span></dt><dd>Type: <a href="95768a75-9990-7529-ec62-9e952321ddcc.htm">Vanara.PInvoke<span id="LST88955B84_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>FileFlagsAndAttributes</a><br />
            The file or device attributes and flags, FILE_ATTRIBUTE_NORMAL being the most common default value for files.
            <p>This parameter can include any combination of the available file attributes (FILE_ATTRIBUTE_*). All other file attributes override FILE_ATTRIBUTE_NORMAL.</p><p>
            This parameter can also contain combinations of flags (FILE_FLAG_*) for control of file or device caching behavior, access modes, and other
            special-purpose flags. These combine with any FILE_ATTRIBUTE_* values.
            </p><p>
            This parameter can also contain Security Quality of Service (SQOS) information by specifying the SECURITY_SQOS_PRESENT flag. Additional SQOS-related
            flags information is presented in the table following the attributes and flags tables.
            </p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td>When CreateFile opens an existing file, it generally combines the file flags with the file attributes of the existing file, and ignores any
            file attributes supplied as part of dwFlagsAndAttributes. Special cases are detailed in Creating and Opening Files.</td></tr></table></div><p>
            Some of the following file attributes and flags may only apply to files and not necessarily all other types of devices that CreateFile can open. For
            additional information, see the Remarks section of this topic and Creating and Opening Files.
            </p><p>
            For more advanced access to file attributes, see SetFileAttributes. For a complete list of all file attributes with their values and descriptions,
            see File Attribute Constants.
            </p></dd><dt><span class="parameter">hTemplateFile</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/3y85x3e7" target="_blank">Microsoft.Win32.SafeHandles<span id="LST88955B84_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST88955B84_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeFileHandle</a><br />
            A valid handle to a template file with the GENERIC_READ access right. The template file supplies file attributes and extended attributes for the file
            that is being created.
            <p>This parameter can be NULL.</p><p>When opening an existing file, CreateFile ignores this parameter.</p><p>
            When opening a new encrypted file, the file inherits the discretionary access control list from its parent directory. For additional information, see
            File Encryption.
            </p></dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/3y85x3e7" target="_blank">SafeFileHandle</a><br />
            If the function succeeds, the return value is an open handle to the specified file, device, named pipe, or mail slot.
            <p>If the function fails, the return value is INVALID_HANDLE_VALUE. To get extended error information, call GetLastError.</p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="44c5555c-a81e-30f0-1ed7-2f42856e9dd3.htm">Kernel32 Class</a></div><div class="seeAlsoStyle"><a href="3812ec5f-2e54-3c57-6aa2-b483db2f48fb.htm">CreateFile Overload</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>