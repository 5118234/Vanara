<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>VirtDisk.AttachVirtualDisk Method (SafeFileHandle, IntPtr, VirtDisk.ATTACH_VIRTUAL_DISK_FLAG, UInt32, VirtDisk.ATTACH_VIRTUAL_DISK_PARAMETERS, NativeOverlapped)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.VirtDisk.AttachVirtualDisk(Microsoft.Win32.SafeHandles.SafeFileHandle,System.IntPtr,Vanara.PInvoke.VirtDisk.ATTACH_VIRTUAL_DISK_FLAG,System.UInt32,Vanara.PInvoke.VirtDisk.ATTACH_VIRTUAL_DISK_PARAMETERS@,System.Threading.NativeOverlapped@)" /><meta name="Description" content="Attaches a virtual hard disk (VHD) or CD or DVD image file (ISO) by locating an appropriate VHD provider to accomplish the attachment." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="91b4494d-18d1-e354-7182-7dd45da515f7" /><meta name="guid" content="91b4494d-18d1-e354-7182-7dd45da515f7" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="cd7419c7-8b13-7877-9c81-7ab1104f0af8.htm" title="VirtDisk Class" tocid="cd7419c7-8b13-7877-9c81-7ab1104f0af8">VirtDisk Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="428b03e5-69cd-36ea-d91d-868166aac0bb.htm" title="VirtDisk Methods" tocid="428b03e5-69cd-36ea-d91d-868166aac0bb">VirtDisk Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="b2ee01f0-0884-d765-bf59-fa70970ff387.htm" title="AttachVirtualDisk Method " tocid="b2ee01f0-0884-d765-bf59-fa70970ff387">AttachVirtualDisk Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="5266be96-94c1-44ee-53df-e536c1d44adc.htm" title="AttachVirtualDisk Method (SafeFileHandle, IntPtr, VirtDisk.ATTACH_VIRTUAL_DISK_FLAG, UInt32, VirtDisk.ATTACH_VIRTUAL_DISK_PARAMETERS, IntPtr)" tocid="5266be96-94c1-44ee-53df-e536c1d44adc">AttachVirtualDisk Method (SafeFileHandle, IntPtr, VirtDisk.ATTACH_VIRTUAL_DISK_FLAG, UInt32, VirtDisk.ATTACH_VIRTUAL_DISK_PARAMETERS, IntPtr)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="91b4494d-18d1-e354-7182-7dd45da515f7.htm" title="AttachVirtualDisk Method (SafeFileHandle, IntPtr, VirtDisk.ATTACH_VIRTUAL_DISK_FLAG, UInt32, VirtDisk.ATTACH_VIRTUAL_DISK_PARAMETERS, NativeOverlapped)" tocid="91b4494d-18d1-e354-7182-7dd45da515f7">AttachVirtualDisk Method (SafeFileHandle, IntPtr, VirtDisk.ATTACH_VIRTUAL_DISK_FLAG, UInt32, VirtDisk.ATTACH_VIRTUAL_DISK_PARAMETERS, NativeOverlapped)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>VirtDisk<span id="LSTDAA79F5F_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_0?cpp=::|nu=.");</script>AttachVirtualDisk Method (SafeFileHandle, IntPtr, VirtDisk<span id="LSTDAA79F5F_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_1?cpp=::|nu=.");</script>ATTACH_VIRTUAL_DISK_FLAG, UInt32, VirtDisk<span id="LSTDAA79F5F_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_2?cpp=::|nu=.");</script>ATTACH_VIRTUAL_DISK_PARAMETERS<span id="LSTDAA79F5F_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_3?cpp=%");</script>, NativeOverlapped<span id="LSTDAA79F5F_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_4?cpp=%");</script>)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">Attaches a virtual hard disk (VHD) or CD or DVD image file (ISO) by locating an appropriate VHD provider to accomplish the attachment.</div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.VirtDisk (in Vanara.PInvoke.VirtDisk.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">Win32Error</span> <span class="identifier">AttachVirtualDisk</span>(
	<span class="identifier">SafeFileHandle</span> <span class="parameter">VirtualDiskHandle</span>,
	<span class="identifier">IntPtr</span> <span class="parameter">SecurityDescriptor</span>,
	<span class="identifier">VirtDisk<span id="LSTDAA79F5F_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ATTACH_VIRTUAL_DISK_FLAG</span> <span class="parameter">Flags</span>,
	<span class="identifier">uint</span> <span class="parameter">ProviderSpecificFlags</span>,
	<span class="keyword">ref</span> <span class="identifier">VirtDisk<span id="LSTDAA79F5F_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ATTACH_VIRTUAL_DISK_PARAMETERS</span> <span class="parameter">Parameters</span>,
	<span class="keyword">ref</span> <span class="identifier">NativeOverlapped</span> <span class="parameter">Overlapped</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">AttachVirtualDisk</span> ( 
	<span class="parameter">VirtualDiskHandle</span> <span class="keyword">As</span> <span class="identifier">SafeFileHandle</span>,
	<span class="parameter">SecurityDescriptor</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">Flags</span> <span class="keyword">As</span> <span class="identifier">VirtDisk<span id="LSTDAA79F5F_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ATTACH_VIRTUAL_DISK_FLAG</span>,
	<span class="parameter">ProviderSpecificFlags</span> <span class="keyword">As</span> <span class="identifier">UInteger</span>,
	<span class="keyword">ByRef</span> <span class="parameter">Parameters</span> <span class="keyword">As</span> <span class="identifier">VirtDisk<span id="LSTDAA79F5F_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ATTACH_VIRTUAL_DISK_PARAMETERS</span>,
	<span class="keyword">ByRef</span> <span class="parameter">Overlapped</span> <span class="keyword">As</span> <span class="identifier">NativeOverlapped</span>
) <span class="keyword">As</span> <span class="identifier">Win32Error</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">VirtualDiskHandle</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/3y85x3e7" target="_blank">Microsoft.Win32.SafeHandles<span id="LSTDAA79F5F_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SafeFileHandle</a><br />A handle to an open virtual disk. For information on how to open a virtual disk, see the OpenVirtualDisk function.</dd><dt><span class="parameter">SecurityDescriptor</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LSTDAA79F5F_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><br />
            An optional pointer to a SECURITY_DESCRIPTOR to apply to the attached virtual disk. If this parameter is NULL, the security descriptor of the virtual
            disk image file is used.
            <p>
            Ensure that the security descriptor that AttachVirtualDisk applies to the attached virtual disk grants the write attributes permission for the user,
            or that the security descriptor of the virtual disk image file grants the write attributes permission for the user if you specify NULL for this
            parameter. If the security descriptor does not grant write attributes permission for a user, Shell displays the following error when the user
            accesses the attached virtual disk: The Recycle Bin is corrupted. Do you want to empty the Recycle Bin for this drive?
            </p></dd><dt><span class="parameter">Flags</span></dt><dd>Type: <a href="2a136ac2-fb1a-79d5-72fb-adc9cee87247.htm">Vanara.PInvoke<span id="LSTDAA79F5F_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>VirtDisk<span id="LSTDAA79F5F_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ATTACH_VIRTUAL_DISK_FLAG</a><br />A valid combination of values of the ATTACH_VIRTUAL_DISK_FLAG enumeration.</dd><dt><span class="parameter">ProviderSpecificFlags</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">System<span id="LSTDAA79F5F_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt32</a><br />Flags specific to the type of virtual disk being attached. May be zero if none are required.</dd><dt><span class="parameter">Parameters</span></dt><dd>Type: <a href="afb0032a-a5b9-a288-cc57-825214641044.htm">Vanara.PInvoke<span id="LSTDAA79F5F_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_14?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>VirtDisk<span id="LSTDAA79F5F_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_15?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>ATTACH_VIRTUAL_DISK_PARAMETERS</a><span id="LSTDAA79F5F_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_16?cpp=%");</script><br />A pointer to a valid ATTACH_VIRTUAL_DISK_PARAMETERS structure that contains attachment parameter data.</dd><dt><span class="parameter">Overlapped</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/7hyt05sc" target="_blank">System.Threading<span id="LSTDAA79F5F_17"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_17?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>NativeOverlapped</a><span id="LSTDAA79F5F_18"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDAA79F5F_18?cpp=%");</script><br />An optional pointer to a valid OVERLAPPED structure if asynchronous operation is desired.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="08c41376-0893-e74a-adcf-6b5194603d48.htm">Win32Error</a><br />
            Status of the request.
            <p>If the function succeeds, the return value is ERROR_SUCCESS.</p><p>If the function fails, the return value is an error code. For more information, see System Error Codes.</p></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="cd7419c7-8b13-7877-9c81-7ab1104f0af8.htm">VirtDisk Class</a></div><div class="seeAlsoStyle"><a href="b2ee01f0-0884-d765-bf59-fa70970ff387.htm">AttachVirtualDisk Overload</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>