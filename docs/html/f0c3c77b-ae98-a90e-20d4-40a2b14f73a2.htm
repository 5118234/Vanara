<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CredUI.CredUIPromptForWindowsCredentials Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="CredUIPromptForWindowsCredentials method" /><meta name="System.Keywords" content="CredUI.CredUIPromptForWindowsCredentials method" /><meta name="Microsoft.Help.F1" content="Vanara.PInvoke.CredUI.CredUIPromptForWindowsCredentials" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.CredUI.CredUIPromptForWindowsCredentials(Vanara.PInvoke.CredUI.CREDUI_INFO@,System.Int32,System.UInt32@,System.IntPtr,System.UInt32,System.IntPtr@,System.UInt32@,System.Boolean@,Vanara.PInvoke.CredUI.WindowsCredentialsDialogOptions)" /><meta name="Description" content="The CredUIPromptForWindowsCredentials function creates and displays a configurable dialog box that allows users to supply credential information by using any credential provider installed on the local computer." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="f0c3c77b-ae98-a90e-20d4-40a2b14f73a2" /><meta name="guid" content="f0c3c77b-ae98-a90e-20d4-40a2b14f73a2" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d445925c-fdc1-230a-be29-e0966d4ee127.htm" title="CredUI Class" tocid="d445925c-fdc1-230a-be29-e0966d4ee127">CredUI Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="2d63e544-46ae-cf06-bc7c-d317fc31cb8d.htm" title="CredUI Methods" tocid="2d63e544-46ae-cf06-bc7c-d317fc31cb8d">CredUI Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="87efc117-dbf4-9c12-ab0e-41947c10f63c.htm" title="CredPackAuthenticationBuffer Method " tocid="87efc117-dbf4-9c12-ab0e-41947c10f63c">CredPackAuthenticationBuffer Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d31b9fdc-1e87-d670-a1e8-01f08ab39228.htm" title="CredUIConfirmCredentials Method " tocid="d31b9fdc-1e87-d670-a1e8-01f08ab39228">CredUIConfirmCredentials Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="fab35c9c-fe4d-455a-3102-36b9ec9e1f6e.htm" title="CredUIParseUserName Method " tocid="fab35c9c-fe4d-455a-3102-36b9ec9e1f6e">CredUIParseUserName Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="fa2179eb-ae04-24b5-2c60-6c106dbf2b18.htm" title="CredUIPromptForCredentials Method " tocid="fa2179eb-ae04-24b5-2c60-6c106dbf2b18">CredUIPromptForCredentials Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="f0c3c77b-ae98-a90e-20d4-40a2b14f73a2.htm" title="CredUIPromptForWindowsCredentials Method " tocid="f0c3c77b-ae98-a90e-20d4-40a2b14f73a2">CredUIPromptForWindowsCredentials Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="9f6d6707-9be5-097a-bef1-906d9b5b3983.htm" title="CredUnPackAuthenticationBuffer Method " tocid="9f6d6707-9be5-097a-bef1-906d9b5b3983">CredUnPackAuthenticationBuffer Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>CredUI<span id="LSTDB1DB5F6_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_0?cpp=::|nu=.");</script>CredUIPromptForWindowsCredentials Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            The CredUIPromptForWindowsCredentials function creates and displays a configurable dialog box that allows users to supply credential information by using any credential provider installed on the local computer.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.CredUI (in Vanara.PInvoke.CredUI.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">int</span> <span class="identifier">CredUIPromptForWindowsCredentials</span>(
	<span class="keyword">ref</span> <span class="identifier">CredUI<span id="LSTDB1DB5F6_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CREDUI_INFO</span> <span class="parameter">pUiInfo</span>,
	<span class="identifier">int</span> <span class="parameter">dwAuthError</span>,
	<span class="keyword">ref</span> <span class="identifier">uint</span> <span class="parameter">pulAuthPackage</span>,
	<span class="identifier">IntPtr</span> <span class="parameter">pvInAuthBuffer</span>,
	<span class="identifier">uint</span> <span class="parameter">ulInAuthBufferSize</span>,
	<span class="keyword">out</span> <span class="identifier">IntPtr</span> <span class="parameter">ppvOutAuthBuffer</span>,
	<span class="keyword">out</span> <span class="identifier">uint</span> <span class="parameter">pulOutAuthBufferSize</span>,
	<span class="keyword">ref</span> <span class="identifier">bool</span> <span class="parameter">pfSave</span>,
	<span class="identifier">CredUI<span id="LSTDB1DB5F6_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>WindowsCredentialsDialogOptions</span> <span class="parameter">dwFlags</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">CredUIPromptForWindowsCredentials</span> ( 
	<span class="keyword">ByRef</span> <span class="parameter">pUiInfo</span> <span class="keyword">As</span> <span class="identifier">CredUI<span id="LSTDB1DB5F6_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CREDUI_INFO</span>,
	<span class="parameter">dwAuthError</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="keyword">ByRef</span> <span class="parameter">pulAuthPackage</span> <span class="keyword">As</span> <span class="identifier">UInteger</span>,
	<span class="parameter">pvInAuthBuffer</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">ulInAuthBufferSize</span> <span class="keyword">As</span> <span class="identifier">UInteger</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">ppvOutAuthBuffer</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">pulOutAuthBufferSize</span> <span class="keyword">As</span> <span class="identifier">UInteger</span>,
	<span class="keyword">ByRef</span> <span class="parameter">pfSave</span> <span class="keyword">As</span> <span class="identifier">Boolean</span>,
	<span class="parameter">dwFlags</span> <span class="keyword">As</span> <span class="identifier">CredUI<span id="LSTDB1DB5F6_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>WindowsCredentialsDialogOptions</span>
) <span class="keyword">As</span> <span class="identifier">Integer</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">pUiInfo</span></dt><dd>Type: <a href="07b7b5ee-a911-67e3-f78b-6a656921658f.htm">Vanara.PInvoke<span id="LSTDB1DB5F6_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CredUI<span id="LSTDB1DB5F6_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CREDUI_INFO</a><span id="LSTDB1DB5F6_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_7?cpp=%");</script><br />A pointer to a CREDUI_INFO structure that contains information for customizing the appearance of the dialog box that this function displays.
            <p>If the hwndParent member of the CREDUI_INFO structure is not NULL, this function displays a modal dialog box centered on the parent window.</p><p>If the hwndParent member of the CREDUI_INFO structure is NULL, the function displays a dialog box centered on the screen.</p><p>This function ignores the hbmBanner member of the CREDUI_INFO structure.</p></dd><dt><span class="parameter">dwAuthError</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LSTDB1DB5F6_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />A Windows error code, defined in Winerror.h, that is displayed in the dialog box. If credentials previously collected were not valid, the caller uses this parameter to pass the error message from the API that collected the credentials (for example, Winlogon) to this function. The corresponding error message is formatted and displayed in the dialog box. Set the value of this parameter to zero to display no error message.</dd><dt><span class="parameter">pulAuthPackage</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">System<span id="LSTDB1DB5F6_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt32</a><span id="LSTDB1DB5F6_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_10?cpp=%");</script><br />On input, the value of this parameter is used to specify the authentication package for which the credentials in the pvInAuthBuffer buffer are serialized. If the value of pvInAuthBuffer is NULL and the CREDUIWIN_AUTHPACKAGE_ONLY flag is set in the dwFlags parameter, only credential providers capable of serializing credentials for the specified authentication package are to be enumerated.
            <p>To get the appropriate value to use for this parameter on input, call the LsaLookupAuthenticationPackage function and use the value of the AuthenticationPackage parameter of that function.</p><p>On output, this parameter specifies the authentication package for which the credentials in the ppvOutAuthBuffer buffer are serialized.</p></dd><dt><span class="parameter">pvInAuthBuffer</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LSTDB1DB5F6_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><br />A pointer to a credential BLOB that is used to populate the credential fields in the dialog box. Set the value of this parameter to NULL to leave the credential fields empty.</dd><dt><span class="parameter">ulInAuthBufferSize</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">System<span id="LSTDB1DB5F6_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt32</a><br />The size, in bytes, of the pvInAuthBuffer buffer.</dd><dt><span class="parameter">ppvOutAuthBuffer</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LSTDB1DB5F6_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><span id="LSTDB1DB5F6_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_14?cpp=%");</script><br />The address of a pointer that, on output, specifies the credential BLOB. For Kerberos, NTLM, or Negotiate credentials, call the CredUnPackAuthenticationBuffer function to convert this BLOB to string representations of the credentials.
            <p>When you have finished using the credential BLOB, clear it from memory by calling the SecureZeroMemory function, and free it by calling the CoTaskMemFree function.</p></dd><dt><span class="parameter">pulOutAuthBufferSize</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ctys3981" target="_blank">System<span id="LSTDB1DB5F6_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_15?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>UInt32</a><span id="LSTDB1DB5F6_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_16?cpp=%");</script><br />The size, in bytes, of the ppvOutAuthBuffer buffer.</dd><dt><span class="parameter">pfSave</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System<span id="LSTDB1DB5F6_17"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_17?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Boolean</a><span id="LSTDB1DB5F6_18"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_18?cpp=%");</script><br />A pointer to a Boolean value that, on input, specifies whether the Save check box is selected in the dialog box that this function displays. On output, the value of this parameter specifies whether the Save check box was selected when the user clicks the Submit button in the dialog box. Set this parameter to NULL to ignore the Save check box.
            <p>This parameter is ignored if the CREDUIWIN_CHECKBOX flag is not set in the dwFlags parameter.</p></dd><dt><span class="parameter">dwFlags</span></dt><dd>Type: <a href="9a17a4e7-8aac-cbbc-c1bc-5c1db4297036.htm">Vanara.PInvoke<span id="LSTDB1DB5F6_19"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_19?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CredUI<span id="LSTDB1DB5F6_20"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTDB1DB5F6_20?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>WindowsCredentialsDialogOptions</a><br />A DWORD value that specifies special behavior for this function. This value can be a bitwise-OR combination of any enumerated value.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">Int32</a><br />Status of the operation is returned.</div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="d445925c-fdc1-230a-be29-e0966d4ee127.htm">CredUI Class</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>