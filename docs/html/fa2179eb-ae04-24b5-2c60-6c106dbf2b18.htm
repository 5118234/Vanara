<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CredUI.CredUIPromptForCredentials Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="CredUIPromptForCredentials method" /><meta name="System.Keywords" content="CredUI.CredUIPromptForCredentials method" /><meta name="Microsoft.Help.F1" content="Vanara.PInvoke.CredUI.CredUIPromptForCredentials" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.CredUI.CredUIPromptForCredentials(Vanara.PInvoke.CredUI.CREDUI_INFO@,System.String,System.IntPtr,System.Int32,System.Text.StringBuilder,System.Int32,System.Text.StringBuilder,System.Int32,System.Boolean@,Vanara.PInvoke.CredUI.CredentialsDialogOptions)" /><meta name="Description" content="The CredUIPromptForCredentials function creates and displays a configurable dialog box that accepts credentials information from a user." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="fa2179eb-ae04-24b5-2c60-6c106dbf2b18" /><meta name="guid" content="fa2179eb-ae04-24b5-2c60-6c106dbf2b18" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d445925c-fdc1-230a-be29-e0966d4ee127.htm" title="CredUI Class" tocid="d445925c-fdc1-230a-be29-e0966d4ee127">CredUI Class</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="2d63e544-46ae-cf06-bc7c-d317fc31cb8d.htm" title="CredUI Methods" tocid="2d63e544-46ae-cf06-bc7c-d317fc31cb8d">CredUI Methods</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="87efc117-dbf4-9c12-ab0e-41947c10f63c.htm" title="CredPackAuthenticationBuffer Method " tocid="87efc117-dbf4-9c12-ab0e-41947c10f63c">CredPackAuthenticationBuffer Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d31b9fdc-1e87-d670-a1e8-01f08ab39228.htm" title="CredUIConfirmCredentials Method " tocid="d31b9fdc-1e87-d670-a1e8-01f08ab39228">CredUIConfirmCredentials Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="fab35c9c-fe4d-455a-3102-36b9ec9e1f6e.htm" title="CredUIParseUserName Method " tocid="fab35c9c-fe4d-455a-3102-36b9ec9e1f6e">CredUIParseUserName Method </a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="fa2179eb-ae04-24b5-2c60-6c106dbf2b18.htm" title="CredUIPromptForCredentials Method " tocid="fa2179eb-ae04-24b5-2c60-6c106dbf2b18">CredUIPromptForCredentials Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="f0c3c77b-ae98-a90e-20d4-40a2b14f73a2.htm" title="CredUIPromptForWindowsCredentials Method " tocid="f0c3c77b-ae98-a90e-20d4-40a2b14f73a2">CredUIPromptForWindowsCredentials Method </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="9f6d6707-9be5-097a-bef1-906d9b5b3983.htm" title="CredUnPackAuthenticationBuffer Method " tocid="9f6d6707-9be5-097a-bef1-906d9b5b3983">CredUnPackAuthenticationBuffer Method </a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>CredUI<span id="LST4774775D_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_0?cpp=::|nu=.");</script>CredUIPromptForCredentials Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            The CredUIPromptForCredentials function creates and displays a configurable dialog box that accepts credentials information from a user.
            <p>Applications that target Windows Vista or Windows Server 2008 should call CredUIPromptForWindowsCredentials instead of this function, for the following reasons:</p><ul><li><strong>CredUIPromptForWindowsCredentials is consistent with the current Windows user interface.</strong> - </li><li><strong>CredUIPromptForWindowsCredentials is more extensible, allowing integration of additional authentication mechanisms such as biometrics and smart cards.</strong> - </li><li><strong>CredUIPromptForWindowsCredentials is compliant with the Common Criteria specification.</strong> - </li></ul></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.CredUI (in Vanara.PInvoke.CredUI.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">Win32Error</span> <span class="identifier">CredUIPromptForCredentials</span>(
	<span class="keyword">ref</span> <span class="identifier">CredUI<span id="LST4774775D_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CREDUI_INFO</span> <span class="parameter">pUiInfo</span>,
	<span class="identifier">string</span> <span class="parameter">pszTargetName</span>,
	<span class="identifier">IntPtr</span> <span class="parameter">Reserved</span>,
	<span class="identifier">int</span> <span class="parameter">dwAuthError</span>,
	<span class="identifier">StringBuilder</span> <span class="parameter">pszUserName</span>,
	<span class="identifier">int</span> <span class="parameter">ulUserNameMaxChars</span>,
	<span class="identifier">StringBuilder</span> <span class="parameter">pszPassword</span>,
	<span class="identifier">int</span> <span class="parameter">ulPasswordMaxChars</span>,
	<span class="keyword">ref</span> <span class="identifier">bool</span> <span class="parameter">pfSave</span>,
	<span class="identifier">CredUI<span id="LST4774775D_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CredentialsDialogOptions</span> <span class="parameter">dwFlags</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">CredUIPromptForCredentials</span> ( 
	<span class="keyword">ByRef</span> <span class="parameter">pUiInfo</span> <span class="keyword">As</span> <span class="identifier">CredUI<span id="LST4774775D_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CREDUI_INFO</span>,
	<span class="parameter">pszTargetName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">Reserved</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">dwAuthError</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">pszUserName</span> <span class="keyword">As</span> <span class="identifier">StringBuilder</span>,
	<span class="parameter">ulUserNameMaxChars</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">pszPassword</span> <span class="keyword">As</span> <span class="identifier">StringBuilder</span>,
	<span class="parameter">ulPasswordMaxChars</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="keyword">ByRef</span> <span class="parameter">pfSave</span> <span class="keyword">As</span> <span class="identifier">Boolean</span>,
	<span class="parameter">dwFlags</span> <span class="keyword">As</span> <span class="identifier">CredUI<span id="LST4774775D_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CredentialsDialogOptions</span>
) <span class="keyword">As</span> <span class="identifier">Win32Error</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">pUiInfo</span></dt><dd>Type: <a href="07b7b5ee-a911-67e3-f78b-6a656921658f.htm">Vanara.PInvoke<span id="LST4774775D_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CredUI<span id="LST4774775D_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CREDUI_INFO</a><span id="LST4774775D_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_7?cpp=%");</script><br />A pointer to a CREDUI_INFO structure that contains information for customizing the appearance of the dialog box.</dd><dt><span class="parameter">pszTargetName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span id="LST4774775D_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>String</a><br />A pointer to a null-terminated string that contains the name of the target for the credentials, typically a server name. For Distributed File System (DFS) connections, this string is of the form ServerName\ShareName. This parameter is used to identify target information when storing and retrieving credentials.</dd><dt><span class="parameter">Reserved</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LST4774775D_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_9?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><br />This parameter is reserved for future use. It must be NULL.</dd><dt><span class="parameter">dwAuthError</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST4774775D_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />Specifies why the credential dialog box is needed. A caller can pass this Windows error parameter, returned by another authentication call, to allow the dialog box to accommodate certain errors. For example, if the password expired status code is passed, the dialog box could prompt the user to change the password on the account.</dd><dt><span class="parameter">pszUserName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/y9sxk6fy" target="_blank">System.Text<span id="LST4774775D_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>StringBuilder</a><br />A pointer to a null-terminated string that contains the user name for the credentials. If a nonzero-length string is passed, the UserName option of the dialog box is prefilled with the string. In the case of credentials other than UserName/Password, a marshaled format of the credential can be passed in. This string is created by calling CredMarshalCredential.
            <p>This function copies the user-supplied name to this buffer, copying a maximum of ulUserNameMaxChars characters. This format can be converted to UserName/Password format by using CredUIParseUsername. A marshaled format can be passed directly to a security support provider (SSP).</p><p>If the CREDUI_FLAGS_DO_NOT_PERSIST flag is not specified, the value returned in this parameter is of a form that should not be inspected, printed, or persisted other than passing it to CredUIParseUsername. The subsequent results of CredUIParseUsername can be passed only to a client-side authentication function such as WNetAddConnection or an SSP function.</p><p>If no domain or server is specified as part of this parameter, the value of the pszTargetName parameter is used as the domain to form a DomainName\UserName pair. On output, this parameter receives a string that contains that DomainName\UserName pair.</p></dd><dt><span class="parameter">ulUserNameMaxChars</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST4774775D_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_12?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />The maximum number of characters that can be copied to pszUserName including the terminating null character.
            <div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td>CREDUI_MAX_USERNAME_LENGTH does not include the terminating null character.</td></tr></table></div></dd><dt><span class="parameter">pszPassword</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/y9sxk6fy" target="_blank">System.Text<span id="LST4774775D_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>StringBuilder</a><br />A pointer to a null-terminated string that contains the password for the credentials. If a nonzero-length string is specified for pszPassword, the password option of the dialog box will be prefilled with the string.
            <p>This function copies the user-supplied password to this buffer, copying a maximum of ulPasswordMaxChars characters. If the CREDUI_FLAGS_DO_NOT_PERSIST flag is not specified, the value returned in this parameter is of a form that should not be inspected, printed, or persisted other than passing it to a client-side authentication function such as WNetAddConnection or an SSP function.</p><p>When you have finished using the password, clear the password from memory by calling the SecureZeroMemory function. For more information about protecting passwords, see Handling Passwords.</p></dd><dt><span class="parameter">ulPasswordMaxChars</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST4774775D_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_14?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />The maximum number of characters that can be copied to pszPassword including the terminating null character.
            <div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td>CREDUI_MAX_USERNAME_LENGTH does not include the terminating null character.</td></tr></table></div></dd><dt><span class="parameter">pfSave</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System<span id="LST4774775D_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_15?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Boolean</a><span id="LST4774775D_16"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_16?cpp=%");</script><br />A pointer to a BOOL that specifies the initial state of the Save check box and receives the state of the Save check box after the user has responded to the dialog box. If this value is not NULL and CredUIPromptForCredentials returns NO_ERROR, then pfSave returns the state of the Save check box when the user chose OK in the dialog box.
            <p>If the CREDUI_FLAGS_PERSIST flag is specified, the Save check box is not displayed, but is considered to be selected.</p><p>If the CREDUI_FLAGS_DO_NOT_PERSIST flag is specified and CREDUI_FLAGS_SHOW_SAVE_CHECK_BOX is not specified, the Save check box is not displayed, but is considered to be cleared.</p><p>An application that needs to use CredUI to prompt the user for credentials, but does not need the credential management services provided by the credential manager, can use pfSave to receive the state of the Save check box after the user closes the dialog box. To do this, the caller must specify CREDUI_FLAGS_DO_NOT_PERSIST and CREDUI_FLAGS_SHOW_SAVE_CHECK_BOX in dwFlags. When CREDUI_FLAGS_DO_NOT_PERSIST and CREDUI_FLAGS_SHOW_SAVE_CHECK_BOX are set, the application is responsible for examining *pfSave after the function returns, and if *pfSave is TRUE, then the application must take the appropriate action to save the user credentials within the resources of the application.</p></dd><dt><span class="parameter">dwFlags</span></dt><dd>Type: <a href="a8ce6f03-2503-41bf-be9d-598d11d53826.htm">Vanara.PInvoke<span id="LST4774775D_17"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_17?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CredUI<span id="LST4774775D_18"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST4774775D_18?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>CredentialsDialogOptions</a><br />A DWORD value that specifies special behavior for this function. This value can be a bitwise-OR combination of any enumerated value.</dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="08c41376-0893-e74a-adcf-6b5194603d48.htm">Win32Error</a><br />Status of the operation is returned.</div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="d445925c-fdc1-230a-be29-e0966d4ee127.htm">CredUI Class</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>