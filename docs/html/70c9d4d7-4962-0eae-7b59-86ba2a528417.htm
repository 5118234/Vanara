<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CredUI.CredUnPackAuthenticationBuffer Method (Int32, IntPtr, Int32, StringBuilder, Int32, StringBuilder, Int32, StringBuilder, Int32)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Vanara.PInvoke.CredUI.CredUnPackAuthenticationBuffer(System.Int32,System.IntPtr,System.Int32,System.Text.StringBuilder,System.Int32@,System.Text.StringBuilder,System.Int32@,System.Text.StringBuilder,System.Int32@)" /><meta name="Description" content="The CredUnPackAuthenticationBuffer function converts an authentication buffer returned by a call to the CredUIPromptForWindowsCredentials function into a string user name and password." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Vanara.PInvoke" /><meta name="file" content="70c9d4d7-4962-0eae-7b59-86ba2a528417" /><meta name="guid" content="70c9d4d7-4962-0eae-7b59-86ba2a528417" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Vanara API Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d22522ce-4106-42b2-81eb-cb37a0f36df8.htm" title="Vanara API Documentation" tocid="roottoc">Vanara API Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm" title="Vanara.PInvoke" tocid="c0250011-c1b9-bc9a-b501-96a9795f44a5">Vanara.PInvoke</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d445925c-fdc1-230a-be29-e0966d4ee127.htm" title="CredUI Class" tocid="d445925c-fdc1-230a-be29-e0966d4ee127">CredUI Class</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="2d63e544-46ae-cf06-bc7c-d317fc31cb8d.htm" title="CredUI Methods" tocid="2d63e544-46ae-cf06-bc7c-d317fc31cb8d">CredUI Methods</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="9f6d6707-9be5-097a-bef1-906d9b5b3983.htm" title="CredUnPackAuthenticationBuffer Method " tocid="9f6d6707-9be5-097a-bef1-906d9b5b3983">CredUnPackAuthenticationBuffer Method </a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="51094658-9ad0-c17b-5743-956a23340e3a.htm" title="CredUnPackAuthenticationBuffer Method (Int32, IntPtr, Int32, IntPtr, Int32, IntPtr, Int32, IntPtr, Int32)" tocid="51094658-9ad0-c17b-5743-956a23340e3a">CredUnPackAuthenticationBuffer Method (Int32, IntPtr, Int32, IntPtr, Int32, IntPtr, Int32, IntPtr, Int32)</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="70c9d4d7-4962-0eae-7b59-86ba2a528417.htm" title="CredUnPackAuthenticationBuffer Method (Int32, IntPtr, Int32, StringBuilder, Int32, StringBuilder, Int32, StringBuilder, Int32)" tocid="70c9d4d7-4962-0eae-7b59-86ba2a528417">CredUnPackAuthenticationBuffer Method (Int32, IntPtr, Int32, StringBuilder, Int32, StringBuilder, Int32, StringBuilder, Int32)</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>CredUI<span id="LST68FA6A90_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_0?cpp=::|nu=.");</script>CredUnPackAuthenticationBuffer Method (Int32, IntPtr, Int32, StringBuilder, Int32<span id="LST68FA6A90_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_1?cpp=%");</script>, StringBuilder, Int32<span id="LST68FA6A90_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_2?cpp=%");</script>, StringBuilder, Int32<span id="LST68FA6A90_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_3?cpp=%");</script>)</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            The CredUnPackAuthenticationBuffer function converts an authentication buffer returned by a call to the CredUIPromptForWindowsCredentials function into a string user name and password.
            </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke</a><br />
    <strong>Assembly:</strong>
   Vanara.PInvoke.CredUI (in Vanara.PInvoke.CredUI.dll) Version: 1.0.2<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">bool</span> <span class="identifier">CredUnPackAuthenticationBuffer</span>(
	<span class="identifier">int</span> <span class="parameter">dwFlags</span>,
	<span class="identifier">IntPtr</span> <span class="parameter">pAuthBuffer</span>,
	<span class="identifier">int</span> <span class="parameter">cbAuthBuffer</span>,
	<span class="identifier">StringBuilder</span> <span class="parameter">pszUserName</span>,
	<span class="keyword">ref</span> <span class="identifier">int</span> <span class="parameter">pcchMaxUserName</span>,
	<span class="identifier">StringBuilder</span> <span class="parameter">pszDomainName</span>,
	<span class="keyword">ref</span> <span class="identifier">int</span> <span class="parameter">pcchMaxDomainame</span>,
	<span class="identifier">StringBuilder</span> <span class="parameter">pszPassword</span>,
	<span class="keyword">ref</span> <span class="identifier">int</span> <span class="parameter">pcchMaxPassword</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">CredUnPackAuthenticationBuffer</span> ( 
	<span class="parameter">dwFlags</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">pAuthBuffer</span> <span class="keyword">As</span> <span class="identifier">IntPtr</span>,
	<span class="parameter">cbAuthBuffer</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">pszUserName</span> <span class="keyword">As</span> <span class="identifier">StringBuilder</span>,
	<span class="keyword">ByRef</span> <span class="parameter">pcchMaxUserName</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">pszDomainName</span> <span class="keyword">As</span> <span class="identifier">StringBuilder</span>,
	<span class="keyword">ByRef</span> <span class="parameter">pcchMaxDomainame</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">pszPassword</span> <span class="keyword">As</span> <span class="identifier">StringBuilder</span>,
	<span class="keyword">ByRef</span> <span class="parameter">pcchMaxPassword</span> <span class="keyword">As</span> <span class="identifier">Integer</span>
) <span class="keyword">As</span> <span class="identifier">Boolean</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">dwFlags</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST68FA6A90_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />Setting the value of this parameter to CRED_PACK_PROTECTED_CREDENTIALS specifies that the function attempts to decrypt the credentials in the authentication buffer. If the credential cannot be decrypted, the function returns FALSE, and a call to the GetLastError function will return the value ERROR_NOT_CAPABLE.
            <p>How the decryption is done depends on the format of the authentication buffer.</p><p>If the authentication buffer is a SEC_WINNT_AUTH_IDENTITY_EX2 structure, the function can decrypt the buffer if it is encrypted by using SspiEncryptAuthIdentityEx with the SEC_WINNT_AUTH_IDENTITY_ENCRYPT_SAME_LOGON option.</p><p>If the authentication buffer is one of the marshaled KERB_*_LOGON structures, the function decrypts the password before returning it in the pszPassword buffer.</p></dd><dt><span class="parameter">pAuthBuffer</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/5he14kz8" target="_blank">System<span id="LST68FA6A90_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_5?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IntPtr</a><br />A pointer to the authentication buffer to be converted.
            <p>This buffer is typically the output of the CredUIPromptForWindowsCredentials or CredPackAuthenticationBuffer function. This must be one of the following types:</p><ul><li><strong>A SEC_WINNT_AUTH_IDENTITY_EX2 structure for identity credentials. The function does not accept other SEC_WINNT_AUTH_IDENTITY structures.</strong> - </li><li><strong>A KERB_INTERACTIVE_LOGON or KERB_INTERACTIVE_UNLOCK_LOGON structure for password credentials.</strong> - </li><li><strong>A KERB_CERTIFICATE_LOGON or KERB_CERTIFICATE_UNLOCK_LOGON structure for smart card certificate credentials.</strong> - </li><li><strong>GENERIC_CRED for generic credentials.</strong> - </li></ul></dd><dt><span class="parameter">cbAuthBuffer</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST68FA6A90_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_6?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><br />The size, in bytes, of the pAuthBuffer buffer.</dd><dt><span class="parameter">pszUserName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/y9sxk6fy" target="_blank">System.Text<span id="LST68FA6A90_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_7?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>StringBuilder</a><br />A pointer to a null-terminated string that receives the user name.
            <p>This string can be a marshaled credential. See Remarks.</p></dd><dt><span class="parameter">pcchMaxUserName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST68FA6A90_8"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_8?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><span id="LST68FA6A90_9"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_9?cpp=%");</script><br />A pointer to a DWORD value that specifies the size, in characters, of the pszUserName buffer. On output, if the buffer is not of sufficient size, specifies the required size, in characters, of the pszUserName buffer. The size includes terminating null character.</dd><dt><span class="parameter">pszDomainName</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/y9sxk6fy" target="_blank">System.Text<span id="LST68FA6A90_10"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_10?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>StringBuilder</a><br />A pointer to a null-terminated string that receives the name of the user's domain.</dd><dt><span class="parameter">pcchMaxDomainame</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST68FA6A90_11"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_11?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><span id="LST68FA6A90_12"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_12?cpp=%");</script><br />A pointer to a DWORD value that specifies the size, in characters, of the pszDomainName buffer. On output, if the buffer is not of sufficient size, specifies the required size, in characters, of the pszDomainName buffer. The size includes the terminating null character. The required size can be zero if there is no domain name.</dd><dt><span class="parameter">pszPassword</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/y9sxk6fy" target="_blank">System.Text<span id="LST68FA6A90_13"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_13?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>StringBuilder</a><br />A pointer to a null-terminated string that receives the password.</dd><dt><span class="parameter">pcchMaxPassword</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span id="LST68FA6A90_14"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_14?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Int32</a><span id="LST68FA6A90_15"></span><script type="text/javascript">AddLanguageSpecificTextSet("LST68FA6A90_15?cpp=%");</script><br />A pointer to a DWORD value that specifies the size, in characters, of the pszPassword buffer. On output, if the buffer is not of sufficient size, specifies the required size, in characters, of the pszPassword buffer. The size includes the terminating null character.
            <p>This string can be a marshaled credential. See Remarks.</p></dd></dl><h4 class="subHeading">Return Value</h4>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">Boolean</a><br />TRUE if the function succeeds; otherwise, FALSE. For extended error information, call the GetLastError function.The following table shows common values for the GetLastError function.</div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID2RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="d445925c-fdc1-230a-be29-e0966d4ee127.htm">CredUI Class</a></div><div class="seeAlsoStyle"><a href="9f6d6707-9be5-097a-bef1-906d9b5b3983.htm">CredUnPackAuthenticationBuffer Overload</a></div><div class="seeAlsoStyle"><a href="c0250011-c1b9-bc9a-b501-96a9795f44a5.htm">Vanara.PInvoke Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"> </div></body></html>